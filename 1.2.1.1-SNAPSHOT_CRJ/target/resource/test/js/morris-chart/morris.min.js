'use strict';(function(){var w,h,z,A,C=[].slice,D={}.hasOwnProperty,B=function(d,b){function a(){this.constructor=d}for(var c in b)D.call(b,c)&&(d[c]=b[c]);a.prototype=b.prototype;d.prototype=new a;d.__super__=b.prototype;return d},x=function(d,b){return function(){return d.apply(b,arguments)}},E=[].indexOf||function(d){for(var b=0,a=this.length;b<a;b++)if(b in this&&this[b]===d)return b;return-1};h=window.Morris={};w=jQuery;h.EventEmitter=function(){function d(){}d.prototype.on=function(b,a){null==this.handlers&&(this.handlers={});null==this.handlers[b]&&(this.handlers[b]=[]);this.handlers[b].push(a);return this};d.prototype.fire=function(){var b,a,c,f,k,e;a=arguments[0];b=2<=arguments.length?C.call(arguments,1):[];if(null!=this.handlers&&null!=this.handlers[a]){k=this.handlers[a];e=[];c=0;for(f=k.length;c<f;c++)a=k[c],e.push(a.apply(null,b));return e}};return d}();h.commas=function(d){var b,a;return null!=d?(a=0>d?"-":"",b=Math.abs(d),d=Math.floor(b).toFixed(0),a+=d.replace(/(?=(?:\d{3})+$)(?!^)/g,","),b=b.toString(),b.length>d.length&&(a+=b.slice(d.length)),a):"-"};h.pad2=function(d){return(10>d?"0":"")+d};h.Grid=function(d){function b(a){var c=this;this.el="string"===typeof a.element?w(document.getElementById(a.element)):w(a.element);if(null==this.el||0===this.el.length)throw Error("Graph container element not found");"static"===this.el.css("position")&&this.el.css("position","relative");this.options=w.extend({},this.gridDefaults,this.defaults||{},a);"string"===typeof this.options.units&&(this.options.postUnits=a.units);this.raphael=new Raphael(this.el[0]);this.elementHeight=this.elementWidth=null;this.dirty=!1;this.init&&this.init();this.setData(this.options.data);this.el.bind("mousemove",function(a){var f;f=c.el.offset();return c.fire("hovermove",a.pageX-f.left,a.pageY-f.top)});this.el.bind("mouseout",function(a){return c.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(a){var f;f=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];a=c.el.offset();c.fire("hover",f.pageX-a.left,f.pageY-a.top);return f});this.el.bind("click",function(a){var f;f=c.el.offset();return c.fire("gridclick",a.pageX-f.left,a.pageY-f.top)});this.postInit&&this.postInit()}B(b,d);b.prototype.gridDefaults={dateFormat:null,axes:!0,grid:!0,gridLineColor:"#aaa",gridStrokeWidth:.5,gridTextColor:"#888",gridTextSize:12,gridTextFamily:"sans-serif",gridTextWeight:"normal",hideHover:!1,yLabelFormat:null,xLabelAngle:0,numLines:5,padding:25,parseTime:!0,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"]};b.prototype.setData=function(a,c){var f,k,b,m,d,g,n,p,q,r,t,u,y,v;null==c&&(c=!0);this.options.data=a;if(null==a||0===a.length)this.data=[],this.raphael.clear(),null!=this.hover&&this.hover.hide();else{u=this.cumulative?0:null;y=this.cumulative?0:null;0<this.options.goals.length&&(d=Math.min.apply(null,this.options.goals),m=Math.max.apply(null,this.options.goals),y=null!=y?Math.min(y,d):d,u=null!=u?Math.max(u,m):m);this.data=function(){var c,f,e;e=[];b=c=0;for(f=a.length;c<f;b=++c){n=a[b];g={};g.label=n[this.options.xkey];this.options.parseTime?(g.x=h.parseDate(g.label),this.options.dateFormat?g.label=this.options.dateFormat(g.x):"number"===typeof g.label&&(g.label=(new Date(g.label)).toString())):(g.x=b,this.options.xLabelFormat&&(g.label=this.options.xLabelFormat(g)));q=0;var d=g,m,l,p,r;p=this.options.ykeys;r=[];k=m=0;for(l=p.length;m<l;k=++m)t=p[k],v=n[t],"string"===typeof v&&(v=parseFloat(v)),null!=v&&"number"!==typeof v&&(v=null),null!=v&&(this.cumulative?q+=v:null!=u?(u=Math.max(v,u),y=Math.min(v,y)):u=y=v),this.cumulative&&null!=q&&(u=Math.max(q,u),y=Math.min(q,y)),r.push(v);d.y=r;e.push(g)}return e}.call(this);this.options.parseTime&&(this.data=this.data.sort(function(a,c){return(a.x>c.x)-(c.x>a.x)}));this.xmin=this.data[0].x;this.xmax=this.data[this.data.length-1].x;this.events=[];this.options.parseTime&&0<this.options.events.length&&(this.events=function(){var a,c,b,k;b=this.options.events;k=[];a=0;for(c=b.length;a<c;a++)f=b[a],k.push(h.parseDate(f));return k}.call(this),this.xmax=Math.max(this.xmax,Math.max.apply(null,this.events)),this.xmin=Math.min(this.xmin,Math.min.apply(null,this.events)));this.xmin===this.xmax&&(--this.xmin,this.xmax+=1);this.ymin=this.yboundary("min",y);this.ymax=this.yboundary("max",u);this.ymin===this.ymax&&(y&&--this.ymin,this.ymax+=1);if(!0===this.options.axes||!0===this.options.grid)this.options.ymax===this.gridDefaults.ymax&&this.options.ymin===this.gridDefaults.ymin?(this.grid=this.autoGridLines(this.ymin,this.ymax,this.options.numLines),this.ymin=Math.min(this.ymin,this.grid[0]),this.ymax=Math.max(this.ymax,this.grid[this.grid.length-1])):(p=(this.ymax-this.ymin)/(this.options.numLines-1),this.grid=function(){var a,c,f,b;b=[];r=a=c=this.ymin;for(f=this.ymax;c<=f?a<=f:a>=f;r=a+=p)b.push(r);return b}.call(this));this.dirty=!0;if(c)return this.redraw()}};b.prototype.yboundary=function(a,c){var f;f=this.options["y"+a];return"string"===typeof f?"auto"===f.slice(0,4)?5<f.length?(f=parseInt(f.slice(5),10),null==c?f:Math[a](c,f)):null!=c?c:0:parseInt(f,10):f};b.prototype.autoGridLines=function(a,c,f){var b,e,m,d,g,n;g=Math.pow(10,Math.floor(Math.log(c-a)/Math.log(10)));e=Math.floor(a/g)*g;b=Math.ceil(c/g)*g;d=(b-e)/(f-1);1===g&&1<d&&Math.ceil(d)!==d&&(d=Math.ceil(d),b=e+d*(f-1));0>e&&0<b&&(e=Math.floor(a/d)*d,b=Math.ceil(c/d)*d);1>d?(m=Math.floor(Math.log(d)/Math.log(10)),a=function(){var a,c;c=[];for(n=a=e;e<=b?a<=b:a>=b;n=a+=d)c.push(parseFloat(n.toFixed(1-m)));return c}()):a=function(){var a,c;c=[];for(n=a=e;e<=b?a<=b:a>=b;n=a+=d)c.push(n);return c}();return a};b.prototype._calc=function(){var a,c,f,b;b=this.el.width();a=this.el.height();if(this.elementWidth!==b||this.elementHeight!==a||this.dirty)if(this.elementWidth=b,this.elementHeight=a,this.dirty=!1,this.left=this.options.padding,this.right=this.elementWidth-this.options.padding,this.top=this.options.padding,this.bottom=this.elementHeight-this.options.padding,this.options.axes&&(a=function(){var a,f,b,k;b=this.grid;k=[];a=0;for(f=b.length;a<f;a++)c=b[a],k.push(this.measureText(this.yAxisFormat(c)).width);return k}.call(this),this.left+=Math.max.apply(Math,a),a=function(){var a,c,b;b=[];f=a=0;for(c=this.data.length;0<=c?a<c:a>c;f=0<=c?++a:--a)b.push(this.measureText(this.data[f].text,-this.options.xLabelAngle).height);return b}.call(this),this.bottom-=Math.max.apply(Math,a)),this.width=Math.max(1,this.right-this.left),this.height=Math.max(1,this.bottom-this.top),this.dx=this.width/(this.xmax-this.xmin),this.dy=this.height/(this.ymax-this.ymin),this.calc)return this.calc()};b.prototype.transY=function(a){return this.bottom-(a-this.ymin)*this.dy};b.prototype.transX=function(a){return 1===this.data.length?(this.left+this.right)/2:this.left+(a-this.xmin)*this.dx};b.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();this.drawGoals();this.drawEvents();if(this.draw)return this.draw()};b.prototype.measureText=function(a,c){null==c&&(c=0);c=this.raphael.text(100,100,a).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).rotate(c);a=c.getBBox();c.remove();return a};b.prototype.yAxisFormat=function(a){return this.yLabelFormat(a)};b.prototype.yLabelFormat=function(a){return"function"===typeof this.options.yLabelFormat?this.options.yLabelFormat(a):""+this.options.preUnits+h.commas(a)+this.options.postUnits};b.prototype.updateHover=function(a,c){var f;a=this.hitTest(a,c);if(null!=a)return(f=this.hover).update.apply(f,a)};b.prototype.drawGrid=function(){var a,c,f,b,e,d;if(!1!==this.options.grid||!1!==this.options.axes){e=this.grid;d=[];f=0;for(b=e.length;f<b;f++)a=e[f],c=this.transY(a),this.options.axes&&this.drawYAxisLabel(this.left-this.options.padding/2,c,this.yAxisFormat(a)),this.options.grid?d.push(this.drawGridLine("M"+this.left+","+c+"H"+(this.left+this.width))):d.push(void 0);return d}};b.prototype.drawGoals=function(){var a,c,f,b,e,d;e=this.options.goals;d=[];a=f=0;for(b=e.length;f<b;a=++f)c=e[a],a=this.options.goalLineColors[a%this.options.goalLineColors.length],d.push(this.drawGoal(c,a));return d};b.prototype.drawEvents=function(){var a,c,f,b,e,d;e=this.events;d=[];a=f=0;for(b=e.length;f<b;a=++f)c=e[a],a=this.options.eventLineColors[a%this.options.eventLineColors.length],d.push(this.drawEvent(c,a));return d};b.prototype.drawGoal=function(a,c){return this.raphael.path("M"+this.left+","+this.transY(a)+"H"+this.right).attr("stroke",c).attr("stroke-width",this.options.goalStrokeWidth)};b.prototype.drawEvent=function(a,c){return this.raphael.path("M"+this.transX(a)+","+this.bottom+"V"+this.top).attr("stroke",c).attr("stroke-width",this.options.eventStrokeWidth)};b.prototype.drawYAxisLabel=function(a,c,f){return this.raphael.text(a,c,f).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor).attr("text-anchor","end")};b.prototype.drawGridLine=function(a){return this.raphael.path(a).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};return b}(h.EventEmitter);h.parseDate=function(d){var b,a,c,f,k,e;if("number"===typeof d)return d;a=d.match(/^(\d+) Q(\d)$/);f=d.match(/^(\d+)-(\d+)$/);k=d.match(/^(\d+)-(\d+)-(\d+)$/);b=d.match(/^(\d+) W(\d+)$/);c=d.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);e=d.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);return a?(new Date(parseInt(a[1],10),3*parseInt(a[2],10)-1,1)).getTime():f?(new Date(parseInt(f[1],10),parseInt(f[2],10)-1,1)).getTime():k?(new Date(parseInt(k[1],10),parseInt(k[2],10)-1,parseInt(k[3],10))).getTime():b?(e=new Date(parseInt(b[1],10),0,1),4!==e.getDay()&&e.setMonth(0,1+(4-e.getDay()+7)%7),e.getTime()+6048E5*parseInt(b[2],10)):c?c[6]?(d=0,"Z"!==c[6]&&(d=60*parseInt(c[8],10)+parseInt(c[9],10),"+"===c[7]&&(d=0-d)),Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10)+d)):(new Date(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10))).getTime():e?(c=parseFloat(e[6]),b=Math.floor(c),c=Math.round(1E3*(c-b)),e[8]?(d=0,"Z"!==e[8]&&(d=60*parseInt(e[10],10)+parseInt(e[11],10),"+"===e[9]&&(d=0-d)),Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10)+d,b,c)):(new Date(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10),b,c)).getTime()):(new Date(parseInt(d,10),0,1)).getTime()};h.Hover=function(){function d(b){null==b&&(b={});this.options=w.extend({},h.Hover.defaults,b);this.el=w("\x3cdiv class\x3d'"+this.options["class"]+"'\x3e\x3c/div\x3e");this.el.hide();this.options.parent.append(this.el)}d.defaults={"class":"morris-hover morris-default-style"};d.prototype.update=function(b,a,c){this.html(b);this.show();return this.moveTo(a,c)};d.prototype.html=function(b){return this.el.html(b)};d.prototype.moveTo=function(b,a){var c,f,k,e;e=this.options.parent.innerWidth();k=this.options.parent.innerHeight();f=this.el.outerWidth();c=this.el.outerHeight();b=Math.min(Math.max(0,b-f/2),e-f);null!=a?(f=a-c-10,0>f&&(f=a+10,f+c>k&&(f=k/2-c/2))):f=k/2-c/2;return this.el.css({left:b+"px",top:parseInt(f)+"px"})};d.prototype.show=function(){return this.el.show()};d.prototype.hide=function(){return this.el.hide()};return d}();h.Line=function(d){function b(a){this.hilight=x(this.hilight,this);this.onHoverOut=x(this.onHoverOut,this);this.onHoverMove=x(this.onHoverMove,this);this.onGridClick=x(this.onGridClick,this);if(!(this instanceof h.Line))return new h.Line(a);b.__super__.constructor.call(this,a)}B(b,d);b.prototype.init=function(){this.pointGrow=Raphael.animation({r:this.options.pointSize+3},25,"linear");this.pointShrink=Raphael.animation({r:this.options.pointSize},25,"linear");if("always"!==this.options.hideHover)return this.hover=new h.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};b.prototype.defaults={lineWidth:3,pointSize:4,lineColors:"#0b62a4 #7A92A3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),pointWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:!0,xLabels:"auto",xLabelFormat:null,xLabelMargin:24,continuousLine:!0,hideHover:!1};b.prototype.calc=function(){this.calcPoints();return this.generatePaths()};b.prototype.calcPoints=function(){var a,c,f,b,e,d;e=this.data;d=[];f=0;for(b=e.length;f<b;f++)a=e[f],a._x=this.transX(a.x),a._y=function(){var f,b,e,k;e=a.y;k=[];f=0;for(b=e.length;f<b;f++)c=e[f],null!=c?k.push(this.transY(c)):k.push(c);return k}.call(this),d.push(a._ymax=Math.min.apply(null,[this.bottom].concat(function(){var f,b,e,k;e=a._y;k=[];f=0;for(b=e.length;f<b;f++)c=e[f],null!=c&&k.push(c);return k}())));return d};b.prototype.hitTest=function(a,c){var f,b,e,d;if(0===this.data.length)return null;d=this.data.slice(1);c=b=0;for(e=d.length;b<e&&!(f=d[c],a<(f._x+this.data[c]._x)/2);c=++b);return c};b.prototype.onGridClick=function(a,c){var f;f=this.hitTest(a,c);return this.fire("click",f,this.options.data[f],a,c)};b.prototype.onHoverMove=function(a,c){a=this.hitTest(a,c);return this.displayHoverForRow(a)};b.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.displayHoverForRow(null)};b.prototype.displayHoverForRow=function(a){var c;if(null!=a)return(c=this.hover).update.apply(c,this.hoverContentForRow(a)),this.hilight(a);this.hover.hide();return this.hilight()};b.prototype.hoverContentForRow=function(a){var c,f,b,e,d,l,g;b=this.data[a];c="\x3cdiv class\x3d'morris-hover-row-label'\x3e"+b.label+"\x3c/div\x3e";g=b.y;f=d=0;for(l=g.length;d<l;f=++d)e=g[f],c+="\x3cdiv class\x3d'morris-hover-point' style\x3d'color: "+this.colorFor(b,f,"label")+"'\x3e\n  "+this.options.labels[f]+":\n  "+this.yLabelFormat(e)+"\n\x3c/div\x3e";"function"===typeof this.options.hoverCallback&&(c=this.options.hoverCallback(a,this.options,c));return[c,b._x,b._ymax]};b.prototype.generatePaths=function(){var a,c,f,b,e;return this.paths=function(){var d,k,g,n;n=[];f=d=0;for(k=this.options.ykeys.length;0<=k?d<k:d>k;f=0<=k?++d:--d)e=!0===this.options.smooth||(g=this.options.ykeys[f],0<=E.call(this.options.smooth,g)),c=function(){var a,c,e,d;e=this.data;d=[];a=0;for(c=e.length;a<c;a++)b=e[a],void 0!==b._y[f]&&d.push({x:b._x,y:b._y[f]});return d}.call(this),this.options.continuousLine&&(c=function(){var f,b,e;e=[];f=0;for(b=c.length;f<b;f++)a=c[f],null!==a.y&&e.push(a);return e}()),1<c.length?n.push(h.Line.createPath(c,e,this.bottom)):n.push(null);return n}.call(this)};b.prototype.draw=function(){this.options.axes&&this.drawXAxis();this.drawSeries();if(!1===this.options.hideHover)return this.displayHoverForRow(this.data.length-1)};b.prototype.drawXAxis=function(){var a,c,f,b,e,d,l,g,n,p,q=this;l=this.bottom+this.options.padding/2;b=e=null;a=function(a,c){var f;a=q.drawXAxisLabel(q.transX(c),l,a);f=a.getBBox();a.transform("r"+-q.options.xLabelAngle);c=a.getBBox();a.transform("t0,"+c.height/2+"...");0!==q.options.xLabelAngle&&(c=-.5*f.width*Math.cos(q.options.xLabelAngle*Math.PI/180),a.transform("t"+c+",0..."));c=a.getBBox();return(null==e||e>=c.x+c.width||null!=b&&b>=c.x)&&0<=c.x&&c.x+c.width<q.el.width()?(0!==q.options.xLabelAngle&&(a=1.25*q.options.gridTextSize/Math.sin(q.options.xLabelAngle*Math.PI/180),b=c.x-a),e=c.x-q.options.xLabelMargin):a.remove()};f=this.options.parseTime?1===this.data.length&&"auto"===this.options.xLabels?[[this.data[0].label,this.data[0].x]]:h.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat):function(){var a,c,f,b;f=this.data;b=[];a=0;for(c=f.length;a<c;a++)d=f[a],b.push([d.label,d.x]);return b}.call(this);f.reverse();p=[];g=0;for(n=f.length;g<n;g++)c=f[g],p.push(a(c[0],c[1]));return p};b.prototype.drawSeries=function(){var a,c,f,b;this.seriesPoints=[];for(a=c=f=this.options.ykeys.length-1;0>=f?0>=c:0<=c;a=0>=f?++c:--c)this._drawLineFor(a);b=[];for(a=c=f=this.options.ykeys.length-1;0>=f?0>=c:0<=c;a=0>=f?++c:--c)b.push(this._drawPointFor(a));return b};b.prototype._drawPointFor=function(a){var c,b,d,e,m,l;this.seriesPoints[a]=[];m=this.data;l=[];d=0;for(e=m.length;d<e;d++)b=m[d],c=null,null!=b._y[a]&&(c=this.drawLinePoint(b._x,b._y[a],this.options.pointSize,this.colorFor(b,a,"point"),a)),l.push(this.seriesPoints[a].push(c));return l};b.prototype._drawLineFor=function(a){var c;c=this.paths[a];if(null!==c)return this.drawLinePath(c,this.colorFor(null,a,"line"))};b.createPath=function(a,c,b){var f,e,d,l,g,n,p,q,r,t;p="";c&&(d=h.Line.gradients(a));q={y:null};l=r=0;for(t=a.length;r<t;l=++r)f=a[l],null!=f.y&&(null!=q.y?c?(e=d[l],n=d[l-1],g=(f.x-q.x)/4,l=q.x+g,n=Math.min(b,q.y+g*n),q=f.x-g,e=Math.min(b,f.y-g*e),p+="C"+l+","+n+","+q+","+e+","+f.x+","+f.y):p+="L"+f.x+","+f.y:c&&null==d[l]||(p+="M"+f.x+","+f.y)),q=f;return p};b.gradients=function(a){var c,b,d,e,m,l,g;b=function(a,c){return(a.y-c.y)/(a.x-c.x)};g=[];d=m=0;for(l=a.length;m<l;d=++m)c=a[d],null!=c.y?(e=a[d+1]||{y:null},d=a[d-1]||{y:null},null!=d.y&&null!=e.y?g.push(b(d,e)):null!=d.y?g.push(b(d,c)):null!=e.y?g.push(b(c,e)):g.push(null)):g.push(null);return g};b.prototype.hilight=function(a){var c,b,d;if(null!==this.prevHilight&&this.prevHilight!==a)for(c=b=0,d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][this.prevHilight]&&this.seriesPoints[c][this.prevHilight].animate(this.pointShrink);if(null!==a&&this.prevHilight!==a)for(c=b=0,d=this.seriesPoints.length-1;0<=d?b<=d:b>=d;c=0<=d?++b:--b)this.seriesPoints[c][a]&&this.seriesPoints[c][a].animate(this.pointGrow);return this.prevHilight=a};b.prototype.colorFor=function(a,c,b){return"function"===typeof this.options.lineColors?this.options.lineColors.call(this,a,c,b):"point"===b?this.options.pointFillColors[c%this.options.pointFillColors.length]||this.options.lineColors[c%this.options.lineColors.length]:this.options.lineColors[c%this.options.lineColors.length]};b.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};b.prototype.drawLinePath=function(a,c){return this.raphael.path(a).attr("stroke",c).attr("stroke-width",this.options.lineWidth)};b.prototype.drawLinePoint=function(a,c,b,d,e){return this.raphael.circle(a,c,b).attr("fill",d).attr("stroke-width",this.strokeWidthForSeries(e)).attr("stroke",this.strokeForSeries(e))};b.prototype.strokeWidthForSeries=function(a){return this.options.pointWidths[a%this.options.pointWidths.length]};b.prototype.strokeForSeries=function(a){return this.options.pointStrokeColors[a%this.options.pointStrokeColors.length]};return b}(h.Grid);h.labelSeries=function(d,b,a,c,f){var k,e,m,l,g;k=200*(b-d)/a;a=new Date(d);c=h.LABEL_SPECS[c];if(void 0===c)for(g=h.AUTO_LABEL_ORDER,m=0,l=g.length;m<l;m++)if(e=g[m],e=h.LABEL_SPECS[e],k>=e.span){c=e;break}void 0===c&&(c=h.LABEL_SPECS.second);f&&(c=w.extend({},c,{fmt:f}));f=c.start(a);for(a=[];(k=f.getTime())<=b;)k>=d&&a.push([c.fmt(f),k]),c.incr(f);return a};z=function(d){return{span:6E4*d,start:function(b){return new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours())},fmt:function(b){return""+h.pad2(b.getHours())+":"+h.pad2(b.getMinutes())},incr:function(b){return b.setUTCMinutes(b.getUTCMinutes()+d)}}};A=function(d){return{span:1E3*d,start:function(b){return new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes())},fmt:function(b){return""+h.pad2(b.getHours())+":"+h.pad2(b.getMinutes())+":"+h.pad2(b.getSeconds())},incr:function(b){return b.setUTCSeconds(b.getUTCSeconds()+d)}}};h.LABEL_SPECS={decade:{span:1728E8,start:function(d){return new Date(d.getFullYear()-d.getFullYear()%10,0,1)},fmt:function(d){return""+d.getFullYear()},incr:function(d){return d.setFullYear(d.getFullYear()+10)}},year:{span:1728E7,start:function(d){return new Date(d.getFullYear(),0,1)},fmt:function(d){return""+d.getFullYear()},incr:function(d){return d.setFullYear(d.getFullYear()+1)}},month:{span:24192E5,start:function(d){return new Date(d.getFullYear(),d.getMonth(),1)},fmt:function(d){return""+d.getFullYear()+"-"+h.pad2(d.getMonth()+1)},incr:function(d){return d.setMonth(d.getMonth()+1)}},day:{span:864E5,start:function(d){return new Date(d.getFullYear(),d.getMonth(),d.getDate())},fmt:function(d){return""+d.getFullYear()+"-"+h.pad2(d.getMonth()+1)+"-"+h.pad2(d.getDate())},incr:function(d){return d.setDate(d.getDate()+1)}},hour:z(60),"30min":z(30),"15min":z(15),"10min":z(10),"5min":z(5),minute:z(1),"30sec":A(30),"15sec":A(15),"10sec":A(10),"5sec":A(5),second:A(1)};h.AUTO_LABEL_ORDER="decade year month day hour 30min 15min 10min 5min minute 30sec 15sec 10sec 5sec second".split(" ");h.Area=function(d){function b(c){if(!(this instanceof h.Area))return new h.Area(c);c=w.extend({},a,c);this.cumulative=!c.behaveLikeLine;"auto"===c.fillOpacity&&(c.fillOpacity=c.behaveLikeLine?.8:1);b.__super__.constructor.call(this,c)}var a;B(b,d);a={fillOpacity:"auto",behaveLikeLine:!1};b.prototype.calcPoints=function(){var a,b,d,e,m,l,g;l=this.data;g=[];e=0;for(m=l.length;e<m;e++){a=l[e];a._x=this.transX(a.x);b=0;var h=a,p,q,r,t;r=a.y;t=[];p=0;for(q=r.length;p<q;p++)d=r[p],this.options.behaveLikeLine?t.push(this.transY(d)):(b+=d||0,t.push(this.transY(b)));h._y=t;g.push(a._ymax=Math.max.apply(Math,a._y))}return g};b.prototype.drawSeries=function(){var a,b,d,e,m,l,g,h;this.seriesPoints=[];b=this.options.behaveLikeLine?function(){l=[];for(var a=0,c=this.options.ykeys.length-1;0<=c?a<=c:a>=c;0<=c?a++:a--)l.push(a);return l}.apply(this):function(){g=[];for(var a=m=this.options.ykeys.length-1;0>=m?0>=a:0<=a;0>=m?a++:a--)g.push(a);return g}.apply(this);h=[];d=0;for(e=b.length;d<e;d++)a=b[d],this._drawFillFor(a),this._drawLineFor(a),h.push(this._drawPointFor(a));return h};b.prototype._drawFillFor=function(a){var c;c=this.paths[a];if(null!==c)return c+="L"+this.transX(this.xmax)+","+this.bottom+"L"+this.transX(this.xmin)+","+this.bottom+"Z",this.drawFilledPath(c,this.fillForSeries(a))};b.prototype.fillForSeries=function(a){a=Raphael.rgb2hsl(this.colorFor(this.data[a],a,"line"));return Raphael.hsl(a.h,this.options.behaveLikeLine?.9*a.s:.75*a.s,Math.min(.98,this.options.behaveLikeLine?1.2*a.l:1.25*a.l))};b.prototype.drawFilledPath=function(a,b){return this.raphael.path(a).attr("fill",b).attr("fill-opacity",this.options.fillOpacity).attr("stroke-width",0)};return b}(h.Line);h.Bar=function(d){function b(a){this.onHoverOut=x(this.onHoverOut,this);this.onHoverMove=x(this.onHoverMove,this);this.onGridClick=x(this.onGridClick,this);if(!(this instanceof h.Bar))return new h.Bar(a);b.__super__.constructor.call(this,w.extend({},a,{parseTime:!1}))}B(b,d);b.prototype.init=function(){this.cumulative=this.options.stacked;if("always"!==this.options.hideHover)return this.hover=new h.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)};b.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:"#0b62a4 #7a92a3 #4da74d #afd8f8 #edc240 #cb4b4b #9440ed".split(" "),xLabelMargin:50};b.prototype.calc=function(){var a;this.calcBars();if(!1===this.options.hideHover)return(a=this.hover).update.apply(a,this.hoverContentForRow(this.data.length-1))};b.prototype.calcBars=function(){var a,c,b,d,e,m,l;m=this.data;l=[];a=d=0;for(e=m.length;d<e;a=++d)c=m[a],c._x=this.left+this.width*(a+.5)/this.data.length,l.push(c._y=function(){var a,f,d,e;d=c.y;e=[];a=0;for(f=d.length;a<f;a++)b=d[a],null!=b?e.push(this.transY(b)):e.push(null);return e}.call(this));return l};b.prototype.draw=function(){this.options.axes&&this.drawXAxis();return this.drawSeries()};b.prototype.drawXAxis=function(){var a,c,b,d,e,m,l,g,h;m=this.bottom+this.options.padding/2;b=e=null;h=[];a=l=0;for(g=this.data.length;0<=g?l<g:l>g;a=0<=g?++l:--l)a=this.data[this.data.length-1-a],c=this.drawXAxisLabel(a._x,m,a.label),d=c.getBBox(),c.transform("r"+-this.options.xLabelAngle),a=c.getBBox(),c.transform("t0,"+a.height/2+"..."),0!==this.options.xLabelAngle&&(d=-.5*d.width*Math.cos(this.options.xLabelAngle*Math.PI/180),c.transform("t"+d+",0...")),(null==e||e>=a.x+a.width||null!=b&&b>=a.x)&&0<=a.x&&a.x+a.width<this.el.width()?(0!==this.options.xLabelAngle&&(b=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),b=a.x-b),h.push(e=a.x-this.options.xLabelMargin)):h.push(c.remove());return h};b.prototype.drawSeries=function(){var a,c,b,d,e,m,l,g,h,p,q,r,t,u;b=this.width/this.options.data.length;g=null!=this.options.stacked?1:this.options.ykeys.length;a=(b*this.options.barSizeRatio-this.options.barGap*(g-1))/g;l=b*(1-this.options.barSizeRatio)/2;u=0>=this.ymin&&0<=this.ymax?this.transY(0):null;return this.bars=function(){var f,k,g,n;g=this.data;n=[];d=f=0;for(k=g.length;f<k;d=++f)h=g[d],e=0,n.push(function(){var f,k,g,n;g=h._y;n=[];p=f=0;for(k=g.length;f<k;p=++f)t=g[p],null!==t?(u?(r=Math.min(t,u),c=Math.max(t,u)):(r=t,c=this.bottom),m=this.left+d*b+l,this.options.stacked||(m+=p*(a+this.options.barGap)),q=c-r,this.options.stacked&&(r-=e),this.drawBar(m,r,a,q,this.colorFor(h,p,"bar")),n.push(e+=q)):n.push(null);return n}.call(this));return n}.call(this)};b.prototype.colorFor=function(a,c,b){return"function"===typeof this.options.barColors?(a={x:a.x,y:a.y[c],label:a.label},c={index:c,key:this.options.ykeys[c],label:this.options.labels[c]},this.options.barColors.call(this,a,c,b)):this.options.barColors[c%this.options.barColors.length]};b.prototype.hitTest=function(a,c){if(0===this.data.length)return null;a=Math.max(Math.min(a,this.right),this.left);return Math.min(this.data.length-1,Math.floor((a-this.left)/(this.width/this.data.length)))};b.prototype.onGridClick=function(a,c){var b;b=this.hitTest(a,c);return this.fire("click",b,this.options.data[b],a,c)};b.prototype.onHoverMove=function(a,c){var b;a=this.hitTest(a,c);return(b=this.hover).update.apply(b,this.hoverContentForRow(a))};b.prototype.onHoverOut=function(){if(!1!==this.options.hideHover)return this.hover.hide()};b.prototype.hoverContentForRow=function(a){var c,b,d,e,h,l,g;d=this.data[a];c="\x3cdiv class\x3d'morris-hover-row-label'\x3e"+d.label+"\x3c/div\x3e";g=d.y;b=h=0;for(l=g.length;h<l;b=++h)e=g[b],c+="\x3cdiv class\x3d'morris-hover-point' style\x3d'color: "+this.colorFor(d,b,"label")+"'\x3e\n  "+this.options.labels[b]+":\n  "+this.yLabelFormat(e)+"\n\x3c/div\x3e";"function"===typeof this.options.hoverCallback&&(c=this.options.hoverCallback(a,this.options,c));return[c,this.left+(a+.5)*this.width/this.data.length]};b.prototype.drawXAxisLabel=function(a,c,b){return this.raphael.text(a,c,b).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};b.prototype.drawBar=function(a,c,b,d,e){return this.raphael.rect(a,c,b,d).attr("fill",e).attr("stroke-width",0)};return b}(h.Grid);h.Donut=function(d){function b(a){this.select=x(this.select,this);this.click=x(this.click,this);if(!(this instanceof h.Donut))return new h.Donut(a);this.el="string"===typeof a.element?w(document.getElementById(a.element)):w(a.element);this.options=w.extend({},this.defaults,a);if(null===this.el||0===this.el.length)throw Error("Graph placeholder not found.");if(void 0!==a.data&&0!==a.data.length){this.data=a.data;var c,b,d,e;d=this.data;e=[];c=0;for(b=d.length;c<b;c++)a=d[c],e.push(parseFloat(a.value));this.values=e;this.redraw()}}B(b,d);b.prototype.defaults={colors:"#0B62A4 #3980B5 #679DC6 #95BBD7 #B0CCE1 #095791 #095085 #083E67 #052C48 #042135".split(" "),backgroundColor:"#FFFFFF",labelColor:"#000000",formatter:h.commas};b.prototype.redraw=function(){var a,b,d,k,e,m,l,g,n,p,q,r,t;this.el.empty();this.raphael=new Raphael(this.el[0]);b=this.el.width()/2;d=this.el.height()/2;p=(Math.min(b,d)-10)/3;g=0;l=this.values;e=0;for(a=l.length;e<a;e++)n=l[e],g+=n;l=5/(2*p);a=1.9999*Math.PI-l*this.data.length;e=m=0;this.segments=[];t=this.values;k=q=0;for(r=t.length;q<r;k=++q)n=t[k],k=m+l+n/g*a,m=new h.DonutSegment(b,d,2*p,p,m,k,this.options.colors[e%this.options.colors.length],this.options.backgroundColor,e,this.raphael),m.render(),this.segments.push(m),m.on("hover",this.select),m.on("click",this.click),m=k,e+=1;this.text1=this.drawEmptyDonutLabel(b,d-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(b,d+10,this.options.labelColor,14);b=Math.max.apply(null,function(){var a,b,c,d;c=this.values;d=[];a=0;for(b=c.length;a<b;a++)n=c[a],d.push(n);return d}.call(this));e=0;p=this.values;a=[];d=0;for(g=p.length;d<g;d++){n=p[d];if(n===b){this.select(e);break}a.push(e+=1)}return a};b.prototype.click=function(a){return this.fire("click",a,this.data[a])};b.prototype.select=function(a){var b,d,k,e;e=this.segments;d=0;for(k=e.length;d<k;d++)b=e[d],b.deselect();this.segments[a].select();a=this.data[a];return this.setLabels(a.label,this.options.formatter(a.value,a))};b.prototype.setLabels=function(a,b){var c,d,e;c=2*(Math.min(this.el.width()/2,this.el.height()/2)-10)/3;e=1.8*c;d=c/2;c/=3;this.text1.attr({text:a,transform:""});a=this.text1.getBBox();d=Math.min(e/a.width,d/a.height);this.text1.attr({transform:"S"+d+","+d+","+(a.x+a.width/2)+","+(a.y+a.height)});this.text2.attr({text:b,transform:""});b=this.text2.getBBox();e=Math.min(e/b.width,c/b.height);return this.text2.attr({transform:"S"+e+","+e+","+(b.x+b.width/2)+","+b.y})};b.prototype.drawEmptyDonutLabel=function(a,b,d,k,e){a=this.raphael.text(a,b,"").attr("font-size",k).attr("fill",d);null!=e&&a.attr("font-weight",e);return a};return b}(h.EventEmitter);h.DonutSegment=function(d){function b(a,b,d,k,e,h,l,g,n,p){this.cx=a;this.cy=b;this.inner=d;this.outer=k;this.color=l;this.backgroundColor=g;this.index=n;this.raphael=p;this.deselect=x(this.deselect,this);this.select=x(this.select,this);this.sin_p0=Math.sin(e);this.cos_p0=Math.cos(e);this.sin_p1=Math.sin(h);this.cos_p1=Math.cos(h);this.is_long=h-e>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}B(b,d);b.prototype.calcArcPoints=function(a){return[this.cx+a*this.sin_p0,this.cy+a*this.cos_p0,this.cx+a*this.sin_p1,this.cy+a*this.cos_p1]};b.prototype.calcSegment=function(a,b){var c,d,e,h,l;h=this.calcArcPoints(a);c=h[0];e=h[1];d=h[2];h=h[3];l=this.calcArcPoints(b);return"M"+c+","+e+("A"+a+","+a+",0,"+this.is_long+",0,"+d+","+h)+("L"+l[2]+","+l[3])+("A"+b+","+b+",0,"+this.is_long+",1,"+l[0]+","+l[1])+"Z"};b.prototype.calcArc=function(a){var b;b=this.calcArcPoints(a);return"M"+b[0]+","+b[1]+("A"+a+","+a+",0,"+this.is_long+",0,"+b[2]+","+b[3])};b.prototype.render=function(){var a=this;this.arc=this.drawDonutArc(this.hilight,this.color);return this.seg=this.drawDonutSegment(this.path,this.color,this.backgroundColor,function(){return a.fire("hover",a.index)},function(){return a.fire("click",a.index)})};b.prototype.drawDonutArc=function(a,b){return this.raphael.path(a).attr({stroke:b,"stroke-width":2,opacity:0})};b.prototype.drawDonutSegment=function(a,b,d,h,e){return this.raphael.path(a).attr({fill:b,stroke:d,"stroke-width":3}).hover(h).click(e)};b.prototype.select=function(){if(!this.selected)return this.seg.animate({path:this.selectedPath},150,"\x3c\x3e"),this.arc.animate({opacity:1},150,"\x3c\x3e"),this.selected=!0};b.prototype.deselect=function(){if(this.selected)return this.seg.animate({path:this.path},150,"\x3c\x3e"),this.arc.animate({opacity:0},150,"\x3c\x3e"),this.selected=!1};return b}(h.EventEmitter)}).call(this);