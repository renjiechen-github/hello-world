'use strict';(function(e){var f={init:function(a){return this.each(function(){var c=e.extend({},e.fn.stepy.defaults,a),b=e(this).data("options",c),d=b.attr("id");if(void 0===d||""==d)d="stepy-"+e("."+b.attr("class")).index(this),b.attr("id",d);var h=e("\x3cul/\x3e",{id:d+"-titles","class":"stepy-titles clearfix"});c.titleTarget?e(c.titleTarget).html(h):h.insertBefore(b);c.validate&&(jQuery.validator.setDefaults({ignore:c.ignore}),b.append('\x3cdiv class\x3d"stepy-error clearfix"/\x3e'));var g=b.children("fieldset"),k=void 0,m=void 0,q="",l="";g.each(function(a){k=e(this);k.addClass("step").attr("id",d+"-step-"+a).append('\x3cp id\x3d"'+d+"-buttons-"+a+'" class\x3d"'+d+'-buttons"/\x3e');m=k.children("legend");c.legend||m.hide();q="";c.description&&(m.length?q="\x3cspan\x3e"+m.html()+"\x3c/span\x3e":e.error(d+": the legend element of the step "+(a+1)+" is required to set the description!"));l=k.attr("title");l=""!=l?"\x3cdiv\x3e"+l+"\x3c/div\x3e":"--";h.append('\x3cli id\x3d"'+d+"-title-"+a+'"\x3e'+l+q+"\x3c/li\x3e");0==a?1<g.length&&f.createNextButton.call(b,a):(f.createBackButton.call(b,a),k.hide(),a<g.length-1&&f.createNextButton.call(b,a))});var n=h.children();n.first().addClass("current-step");var p=b.children(".finish");if(c.finishButton)if(p.length){var t=b.is("form"),r=void 0;c.finish&&t&&(r=b.attr("onsubmit"),b.attr("onsubmit","return false;"));p.click(function(a){c.finish&&!f.execute.call(b,c.finish,g.length-1)?a.preventDefault():t&&(r?b.attr("onsubmit",r):b.removeAttr("onsubmit"),"submit"==p.attr("type")||c.validate&&!f.validate.call(b,g.length-1)||b.submit())});p.appendTo(b.find("p:last"))}else e.error(d+': element with class name "finish" missing!');c.titleClick?n.click(function(){var a=n.filter(".current-step").attr("id").split("-"),a=parseInt(a[a.length-1],10),d=e(this).index();if(d>a){if(c.next&&!f.execute.call(b,c.next,d))return!1}else if(d<a&&c.back&&!f.execute.call(b,c.back,d))return!1;d!=a&&f.step.call(b,d+1)}):n.css("cursor","default");g.delegate('input[type\x3d"text"], input[type\x3d"password"]',"keypress",function(a){if(13==(a.keyCode?a.keyCode:a.which)&&(a.preventDefault(),a=e(this).parent().children("."+d+"-buttons"),a.length)){var b=a.children(".button-next");b.length?b.click():(a=a.children(".finish"),a.length&&a.click())}});g.first().find(":input:visible:enabled").first().select().focus()})},createBackButton:function(a){var c=this,b=this.attr("id"),d=this.data("options");e("\x3ca/\x3e",{id:b+"-back-"+a,href:"javascript:void(0);","class":"button-back btn btn-info",html:d.backLabel}).click(function(){d.back&&!f.execute.call(c,d.back,a-1)||f.step.call(c,a-1+1)}).appendTo(e("#"+b+"-buttons-"+a))},createNextButton:function(a){var c=this,b=this.attr("id"),d=this.data("options");e("\x3ca/\x3e",{id:b+"-next-"+a,href:"javascript:void(0);","class":"button-next  btn btn-info",html:d.nextLabel}).click(function(){d.next&&!f.execute.call(c,d.next,a+1)||f.step.call(c,a+1+1)}).appendTo(e("#"+b+"-buttons-"+a))},execute:function(a,c){return(a=a.call(this,c+1))||void 0===a},step:function(a){a--;var c=this.children("fieldset");a>c.length-1&&(a=c.length-1);var b=this.data("options");max=a;if(b.validate)for(var d=!0,h=0;h<a;h++)if(d&=f.validate.call(this,h),b.block&&!d){max=h;break}c.hide().eq(max).show();e("#"+this.attr("id")+"-titles").children().removeClass("current-step").eq(max).addClass("current-step");this.is("form")&&(max==a?c.eq(max).find(":input:enabled:visible"):c.eq(max).find(".error").select().focus()).first().select().focus();b.select&&b.select.call(this,max+1);return this},validate:function(a){if(!this.is("form"))return!0;var c=this.children("fieldset").eq(a),b=!0,d=e("#"+this.attr("id")+"-titles").children().eq(a),f=this.data("options"),g=this.validate();e(c.find(":input:enabled").get().reverse()).each(function(){var a=g.element(e(this));void 0===a&&(a=!0);(b&=a)?f.errorImage&&d.removeClass("error-image"):(f.errorImage&&d.addClass("error-image"),g.focusInvalid())});return b}};e.fn.stepy=function(a){if(f[a])return f[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)e.error("Method "+a+" does not exist!");else return f.init.apply(this,arguments)};e.fn.stepy.defaults={back:void 0,backLabel:"\x26lt; Back",block:!1,description:!0,errorImage:!1,finish:void 0,finishButton:!0,legend:!0,ignore:"",next:void 0,nextLabel:"Next \x26gt;",titleClick:!1,titleTarget:void 0,validate:!1,select:void 0}})(jQuery);