'use strict';(function(Z){function rc(){function p(d,e){d.attr("transform",function(d){return"translate("+(e(d)+E)+", 0)"})}function r(d,e){d.attr("transform",function(d){return"translate(0,"+e(d)+")"})}function Z(d){var e=d[0];d=d[d.length-1];return e<d?[e,d]:[d,e]}function ua(d){for(var e=[],p=Math.ceil(d[0]);p<d[1];p++)e.push(p);0<e.length&&0<e[0]&&e.unshift(e[0]-(e[1]-e[0]));return e}function n(n){n.each(function(){var n=d.select(this),S=ua(H.domain()),C=n.selectAll(".tick.major").data(S,String),z=C.enter().insert("g","path").attr("class","tick major").style("opacity",1E-6),B=d.transition(C.exit()).style("opacity",1E-6).remove(),aa=d.transition(C).style("opacity",1),L,M=H.rangeExtent?H.rangeExtent():Z(H.range()),n=n.selectAll(".domain").data([0]);n.enter().append("path").attr("class","domain");var n=d.transition(n),N=H.copy(),ab=this.__chart__||N;this.__chart__=N;z.append("line");z.append("text");var ba=z.select("line"),va=aa.select("line"),ma=C.select("text"),Na=z.select("text"),na=aa.select("text");E=(N(1)-N(0))/2;C=ca?0:E;switch(v){case "bottom":L=p;ba.attr("y2",6);Na.attr("y",Math.max(6,0)+3);va.attr("x1",C).attr("x2",C).attr("y2",6);na.attr("x",0).attr("y",Math.max(6,0)+3);ma.attr("dy",".71em").style("text-anchor","middle");ma.text(function(d){return S.length<O||0===d%Math.ceil(S.length/O)?d<e.length?e[d]:d:""});n.attr("d","M"+M[0]+",6V0H"+M[1]+"V6");break;case "left":L=r,ba.attr("x2",-6),Na.attr("x",-(Math.max(6,0)+3)),va.attr("x2",-6).attr("y2",0),na.attr("x",-(Math.max(6,0)+3)).attr("y",E),ma.attr("dy",".32em").style("text-anchor","end"),ma.text(function(d){return S.length<O||0===d%Math.ceil(S.length/O)?d<e.length?e[d]:d:""}),n.attr("d","M-6,"+M[0]+"H0V"+M[1]+"H-6")}if(H.ticks)z.call(L,ab),aa.call(L,N),B.call(L,N);else{var Oa=N.rangeBand()/2,B=function(d){return N(d)+Oa};z.call(L,B);aa.call(L,B)}})}var H=d.scale.linear(),v="bottom",ca=!1,O=10,E=0,e=[];n.scale=function(d){if(!arguments.length)return H;H=d;return n};n.orient=function(d){if(!arguments.length)return v;v=d in{top:1,right:1,bottom:1,left:1}?d+"":"bottom";return n};n.categories=function(d){if(!arguments.length)return e;e=d;return n};n.tickCentered=function(d){if(!arguments.length)return ca;ca=d;return n};n.tickTextNum=function(d){if(!arguments.length)return O;O=d;return n};n.tickOffset=function(){return E};n.ticks=function(){};return n}function r(d){return"undefined"===typeof d}function p(d){return"undefined"!==typeof d}var bb=Z.c3={},d=Z.d3;bb.generate=function(B){var wb,xb,ua,n,H,v,ca,O,E;function e(a,b){for(var c=B,f=0;f<a.length;f++){if(!(a[f]in c))return b;c=c[a[f]]}return c}function S(){cb=null===zb?+d.select(oa).style("width").replace("px",""):zb;var a=null===Ab?+d.select(oa).style("height").replace("px",""):Ab;pa=0<a?a:320;Bb=20+Cb+da;Db=!Eb||h||db?0:50;Pa=eb?0:40;Fb=pa-Cb-da;Gb=20+da;Hb=pa-da;v=0;ca=Db;O=Bb;E=Pa;ua=Fb;n=Gb;H=Pa;wb=Hb;xb=Pa;q=cb-E-ca;t=pa-v-O;ea=pa-ua-n}function vb(){Ib=h?10:0;Jb=h?t:q;fb=h?0:t;gb=h?q:1;m=$a(Ib,Jb,p(m)?m.domain():void 0,function(){return I.tickOffset()});x=C(fb,gb,p(x)?x.domain():void 0);P=C(fb,gb,p(P)?P.domain():void 0);T=$a(0,q,p(Q)?Q:void 0,function(a){return 0===a%1?wa.tickOffset():0});Qa=C(ea,10);Ra=C(ea,10);I=aa(m,sc);fa=L(x,tc);Sa=L(P,uc);wa=aa(T,"bottom")}function $a(a,b,c,f){var g=(A?d.time.scale():d.scale.linear()).range([a,b]);g.orgDomain=function(){return g.domain()};p(c)&&g.domain(c);r(f)&&(f=function(){return 0});if(ga){var e=g,h,g=function(a){return e(a)+f(a)};for(h in e)g[h]=e[h];g.orgDomain=function(){return e.domain()};g.domain=function(a){if(!arguments.length)return a=e.domain(),[a[0],a[1]+1];e.domain(a);return g}}return g}function C(a,b){return d.scale.linear().range([a,b])}function z(a){return"y2"===M(a)?P:x}function Ma(a){return"y2"===M(a)?Ra:Qa}function aa(a,b){a=(ga?rc():d.svg.axis()).scale(a).orient(b);A&&a.tickFormat(Kb?function(a){return d.time.format(Kb)(a)}:wc);ga?a.categories(xa).tickCentered(xc):a.tickOffset=function(){return 0};return a}function L(a,b){return d.svg.axis().scale(a).orient(b)}function M(a){return a in Lb?Lb[a]:"y"}function N(a){return d.min(a,function(a){return d.min(a.values,function(a){return a.value})})}function ab(a){var b={},c,f;a.forEach(function(a){b[a.id]=[];a.values.forEach(function(c){b[a.id].push(c.value)})});for(c=0;c<u.length;c++)for(f=1;f<u[c].length;f++)ya(u[c][f])&&(r(b[u[c][f]])||b[u[c][f]].forEach(function(a,d){M(u[c][f])===M(u[c][0])&&(b[u[c][0]][d]+=1*a)}));return d.max(Object.keys(b).map(function(a){return d.max(b[a])}))}function ba(a,b){a=Ta(function(a){return M(a.id)===b});var c="y2"===b?yc:zc,f="y2"===b?Ac:Bc,c=null!==c?c:N(a),f=null!==f?f:ab(a),g=.1*Math.abs(f-c),d=g,e=g,h="y2"===b?Cc:Dc;null!==h&&(c=Math.max(Math.abs(c),Math.abs(f)),f=c-h,c=h-c);"y"===b&&null!==za&&(d=p(za.top)?za.top:g,e=p(za.bottom)?za.bottom:g);"y2"===b&&null!==Aa&&(d=p(Aa.top)?Aa.top:g,e=p(Aa.bottom)?Aa.bottom:g);return[Ec(a,"bar")?0:c-e,f+d]}function va(a){var b;a?(a=m.domain(),b=F.extent()):(a=Q,b=m.domain());return(a[1]-a[0])/(b[1]-b[0])}function ma(a){for(var b=0;b<a.length;b++)if(!(a[b]in Ua))return!1;return!0}function Na(a){for(var b=[],c=0;c<a.length;c++)a[c]in Ua&&b.push(Mb(Ua[a[c]]));return b}function na(a){return"start"in a?m(A?ha(a.start):a.start):0}function Oa(a){var b=na(a);a=("end"in a?m(A?ha(a.end):a.end):q)-b;return 0>a?0:a}function yb(a){var b=Ba[a.id];a.name=p(b)?b:a.id;return a}function Nb(a){var b=a[0],c,f=[],g,d;for(g=1;g<a.length;g++){c={};for(d=0;d<a[g].length;d++)c[b[d]]=a[g][d];f.push(c)}return f}function Ob(a){var b=[],c,f,g;for(c=0;c<a.length;c++)for(g=a[c][0],f=1;f<a[c].length;f++)r(b[f-1])&&(b[f-1]={}),b[f-1][g]=a[c][f];return b}function Ca(a){var b=d.keys(a[0]).filter(function(a){return a!==ia}),c=0,f;if(A&&!ia)return Z.alert('data.x must be specified when axis.x.type \x3d\x3d "timeseries"'),[];a.forEach(function(a){if(A){if(!(ia in a))throw Error("'"+ia+"' must be included in data");f=ha(a[ia]);if(null===f)throw Error("Failed to parse timeseries date in data");a.x=f}else a.x=Pb?a[ia]:c++;null===Va&&(Va=new Date(a.x));hb=new Date(a.x)});b=b.map(function(b){var c=Fc(b);return{id:c,id_org:b,values:a.map(function(a){return{x:a.x,value:null!==a[b]?+a[b]:null,id:c}})}});b.forEach(function(a){Ua[a.id_org]=Mb(a)});return b}function Mb(a){return{id:a.id,id_org:a.id_org,values:a.values.map(function(a){return{x:a.x,value:a.value,id:a.id}})}}function Da(){return d.max(l.data.targets,function(a){return a.values.length})}function ib(a){a=r(a)?l.data.targets:a;return a.map(function(a){return a.id})}function jb(a){var b=ib(),c;for(c=0;c<b.length;c++)if(b[c]===a)return!0;return!1}function Ta(a){return p(a)?l.data.targets.filter(a):l.data.targets}function kb(a){return"-shapes -shapes-"+a.id}function Qb(a){return kb(a)+" -line -line-"+a.id}function bb(a){return kb(a)+" -circles -circles-"+a.id}function Rb(a){return kb(a)+" -bars -bars-"+a.id}function Gc(a,b){return"-shape -shape-"+b+" -circle -circle-"+b}function Sb(a,b){return"-shape -shape-"+b+" -bar -bar-"+b}function Hc(a,b){return"region region-"+b+" "+("classes"in a?[].concat(a.classes).join(" "):"")}function Wa(a){return m(a.x)}function Ea(a){return m(A?ha(a.value):a.value)}function Tb(a){return x(a.value)}function U(a){return m(a.x)}function V(a){return z(a.id)(a.value)}function Ic(){var a={},b=0,c,f;Ta(ya).forEach(function(d){for(c=0;c<u.length;c++)if(!(0>u[c].indexOf(d.id)))for(f=0;f<u[c].length;f++)if(u[c][f]in a){a[d.id]=a[u[c][f]];break}r(a[d.id])&&(a[d.id]=b++)});a.__max__=b-1;return a}function Ub(a,b,c,d){var f=d?T:m;return function(d){var g=d.id in c?c[d.id]:0;return f(d.x)-a*(b/2-g)}}function Vb(a,b,c,d){var f=Object.keys(b);return function(g,e){var h=0,vc=d?Ma(g.id):z(g.id);Ta(ya).forEach(function(c){c.id!==g.id&&b[c.id]===b[g.id]&&f.indexOf(c.id)<f.indexOf(g.id)&&(h+=a(c.values[e]))});return c?h:vc(g.value)-h}}function Wb(a,b,c){return ga?1.2*a.tickOffset()/b:(h?t:q)*va(c)/(Da()-1)*.6}function Xb(a,b){var c=null===a?function(a){return a}:function(b){return a-b};return function(a){var d=b?Ma(a.id):z(a.id);return c(d(a.value))}}function lb(a,b){a=r(a)?ib():a;"string"===typeof a&&(a=[a]);for(var c=0;c<a.length;c++)W[a[c]]=b}function Ec(a,b){var c=!1;a.forEach(function(a){W[a.id]===b&&(c=!0);a.id in W||"line"!==b||(c=!0)});return c}function mb(a){a="string"===typeof a?a:a.id;return!(a in W)||"line"===W[a]||"spline"===W[a]}function ya(a){return"bar"===W["string"===typeof a?a:a.id]}function Jc(a){return mb(a)?a.values:[]}function Yb(a){return ya(a)?a.values:[]}function Zb(a,b){var c=d.mouse(a),f=d.select(a);a=1*f.attr("cx");f=1*f.attr("cy");return Math.sqrt(Math.pow(a-c[0],2)+Math.pow(f-c[1],2))<b}function $b(a){var b=d.mouse(a),c=d.select(a);a=1*c.attr("x");var f=1*c.attr("y"),c=1*c.attr("width");return a-10<b[0]&&b[0]<a+c+10&&f-10<b[1]}function Kc(a,b){var c;for(c=0;c<b.length;c++)if(b[c].start<a&&a<=b[c].end)return!0;return!1}function ac(a,b,c){Lc(a,b);k.select(".selected-circles-"+b.id).selectAll(".selected-circle-"+c).data([b]).enter().append("circle").attr("class",function(){return"selected-circle selected-circle-"+c}).attr("cx",h?V:U).attr("cy",h?U:V).attr("stroke",function(){return R(b.id)}).attr("r",1.4*Fa).transition().duration(100).attr("r",Fa)}function nb(a,b,c){Mc(a,b);k.select(".selected-circles-"+b.id).selectAll(".selected-circle-"+c).transition().duration(100).attr("r",0).remove()}function bc(a,b,c,d){a?ac(b,c,d):nb(b,c,d)}function Nc(){}function cc(){}function dc(a,b,c,d){}function ec(a){return a.filter(function(a){return null!==a.value})}function Oc(a,b,c,d){var g,f,e="M",k,l,m,fc,n,q=[];if(p(d))for(g=0;g<d.length;g++)q[g]={},r(d[g].start)?q[g].start=a[0].x:A&&(q[g].start=ha(d[g].start)),r(d[g].end)?q[g].end=a[a.length-1].x:A&&(q[g].end=ha(d[g].end));fc=h?function(a){return c(a.value)}:function(a){return b(a.x)};n=h?function(a){return b(a.x)}:function(a){return c(a.value)};d=A?function(a,d,g,f){var e=a.x.getTime();a=d.x-a.x;d=new Date(e+a*(g+f));return"M"+b(new Date(e+a*g))+" "+c(l(g))+" "+b(d)+" "+c(l(g+f))}:function(a,d,g,f){return"M"+b(k(g))+" "+c(l(g))+" "+b(k(g+f))+" "+c(l(g+f))};for(g=0;g<a.length;g++)if(r(q)||!Kc(a[g].x,q))e+=" "+fc(a[g])+" "+n(a[g]);else{k=$a(a[g-1].x,a[g].x);l=C(a[g-1].value,a[g].value);f=b(a[g].x)-b(a[g-1].x);m=c(a[g].value)-c(a[g-1].value);f=Math.sqrt(Math.pow(f,2)+Math.pow(m,2));m=2/f;var t=2*m;for(f=m;1>=f;f+=t)e+=d(a[g-1],a[g],f,m)}return e}function ob(a){var b=l.data.targets=Ca(a),c,f;gc=d.select(oa);if(gc.empty())Z.alert('No bind element found. Check the selector specified by "bindto" and existance of that element. Default "bindto" is "#chart".');else{S();vb();m.domain(d.extent(a.map(function(a){return a.x})));x.domain(ba(b,"y"));P.domain(ba(b,"y2"));T.domain(m.domain());Qa.domain(x.domain());Ra.domain(P.domain());I.ticks(10>a.length?a.length:10);fa.ticks(Pc).outerTickSize(0).tickFormat(Qc);Sa.ticks(Rc).outerTickSize(0).tickFormat(Sc);Q=m.domain();F.x(T);ja&&G.x(m);Ga=d.select(oa).append("svg").attr("width",q+E+ca).attr("height",t+v+O).on("mouseenter",Tc).on("mouseleave",Uc);Xa=Ga.append("defs");Xa.append("clipPath").attr("id",pb).append("rect").attr("y",v).attr("width",q).attr("height",t-v);Xa.append("clipPath").attr("id","xaxis-clip").append("rect").attr("x",-1).attr("y",-1).attr("width",q+2).attr("height",40);Xa.append("clipPath").attr("id","yaxis-clip").append("rect").attr("x",-E+1).attr("y",v-1).attr("width",E).attr("height",t-v+2);k=Ga.append("g").attr("transform",J.main);w=qa?Ga.append("g").attr("transform",J.context):null;ra=sa?Ga.append("g").attr("transform",J.legend):null;X=d.select(oa).style("position","relative").append("div").style("position","absolute").style("width","30%").style("z-index","10").style("visibility","hidden");k.append("g").attr("class","x axis").attr("clip-path",h?"":"url(#xaxis-clip)").attr("transform",J.x).call(h?fa:I);k.append("g").attr("class","y axis").attr("clip-path",h?"url(#yaxis-clip)":"").call(h?I:fa).append("text").attr("transform","rotate(-90)").attr("dy","1.4em").attr("dx","-.8em").style("text-anchor","end").text(Vc);Eb&&k.append("g").attr("class","y2 axis").attr("transform",J.y2).call(Sa);c=k.append("g").attr("clip-path",Ha).attr("class","grid");hc&&c.append("g").attr("class","xgrids");qb&&(f=c.append("g").attr("class","xgrid-lines").selectAll(".xgrid-line").data(qb).enter().append("g").attr("class","xgrid-line"),f.append("line").attr("class",function(a){return""+a["class"]}),f.append("text").attr("class",function(a){return""+a["class"]}).attr("text-anchor","end").attr("transform",h?"":"rotate(-90)").attr("dx",h?0:-v).attr("dy",-6).text(function(a){return a.text}));Wc&&c.append("g").attr("class","xgrid-focus").append("line").attr("class","xgrid-focus").attr("x1",h?0:-10).attr("x2",h?q:-10).attr("y1",h?-10:v).attr("y2",h?-10:t);ic&&c.append("g").attr("class","ygrids");rb&&c.append("g").attr("class","ygrid-lines").selectAll("ygrid-line").data(rb).enter().append("line").attr("class",function(a){return"ygrid-line "+a["class"]});k.append("g").attr("clip-path",Ha).attr("class","regions");k.append("g").attr("clip-path",Ha).attr("class","chart");k.select(".chart").append("g").attr("class","event-rects").style("fill-opacity",0).style("cursor",ja?"ew-resize":null).selectAll(".event-rects").data(a).enter().append("rect").attr("class",function(a,b){return"event-rect event-rect-"+b}).style("cursor",Y&&ka?"pointer":null).on("mouseover",function(a,b){if(!Ya){a=l.data.targets.map(function(a){return yb(a.values[b])});var c,f;if(0<Object.keys(Ba).length){f=[];for(var g in Ba)for(c=0;c<a.length;c++)if(a[c].id===g){f.push(a[c]);a.shift(c);break}a=f.concat(a)}jc&&k.selectAll(".-circle-"+b).classed("_expanded_",!0).attr("r",kc);k.selectAll(".-bar-"+b).classed("_expanded_",!0);k.selectAll("line.xgrid-focus").style("visibility","visible").data([a[0]]).attr(h?"y1":"x1",Wa).attr(h?"y2":"x2",Wa);X.style("top",d.mouse(this)[1]+30+"px").style("left",(h?d.mouse(this)[0]:m(a[0].x))+60+"px");X.html(lc(a));X.style("visibility","visible")}}).on("mouseout",function(a,b){k.select("line.xgrid-focus").style("visibility","hidden");X.style("visibility","hidden");k.selectAll(".-circle-"+b).filter(function(){return d.select(this).classed("_expanded_")}).classed("_expanded_",!1).attr("r",sb);k.selectAll(".-bar-"+b).classed("_expanded_",!1)}).on("mousemove",function(a,b){Y&&!Ya&&(ka||k.selectAll(".-shape-"+b).filter(function(a){return la(a)}).each(function(){var a=d.select(this).classed("_expanded_",!0);"circle"===this.nodeName&&a.attr("r",kc);d.select(".event-rect-"+b).style("cursor",null)}).filter(function(){var a=d.select(this);if("circle"===this.nodeName)return Zb(this,Fa);if("rect"===this.nodeName)return $b(this,a.attr("x"),a.attr("y"))}).each(function(){var a=d.select(this);a.classed("_expanded_")||(a.classed("_expanded_",!0),"circle"===this.nodeName&&a.attr("r",Fa));d.select(".event-rect-"+b).style("cursor","pointer")}))}).on("click",function(a,b){tb?tb=!1:k.selectAll(".-shape-"+b).each(function(a){var c=d.select(this),f=c.classed("_selected_"),g=!1,e;"circle"===this.nodeName?(g=Zb(this,1.5*Fa),e=bc):"rect"===this.nodeName&&(g=$b(this),e=dc);if(ka||g)Y&&la(a)&&(c.classed("_selected_",!f),e(!f,c,a,b)),Xc(a,c)})}).call(d.behavior.drag().origin(Object).on("drag",function(){if(Y&&(!ja||G.altDomain)){var a=ub[0],b=ub[1],c=d.mouse(this),f=c[0],c=c[1],e=Math.min(a,f),h=Math.max(a,f),l=ka?v:Math.min(b,c),m=ka?t:Math.max(b,c);k.select(".dragarea").attr("x",e).attr("y",l).attr("width",h-e).attr("height",m-l);k.selectAll(".-shapes").selectAll(".-shape").filter(function(a){return la(a)}).each(function(a,b){var c=d.select(this),f=c.classed("_selected_"),g=c.classed("_included_"),k,p,n,q;k=!1;"circle"===this.nodeName?(k=1*c.attr("cx"),p=1*c.attr("cy"),q=bc,k=e<k&&k<h&&l<p&&p<m):"rect"===this.nodeName&&(k=1*c.attr("x"),p=1*c.attr("y"),n=1*c.attr("width"),q=dc,k=e<k+n&&k<h&&p<m);k^g&&(c.classed("_included_",!g),c.classed("_selected_",!f),q(!f,c,a,b))})}}).on("dragstart",function(){Y&&(ub=d.mouse(this),k.select(".chart").append("rect").attr("class","dragarea").style("opacity",.1),Ya=!0)}).on("dragend",function(){Y&&(k.select(".dragarea").transition().duration(100).style("opacity",0).remove(),k.selectAll(".-shape").classed("_included_",!1),Ya=!1)})).call(G).on("dblclick.zoom",null);k.select(".chart").append("g").attr("class","chart-bars");k.select(".chart").append("g").attr("class","chart-lines");if(ja)k.insert("rect",Yc?null:"g.grid").attr("class","zoom-rect").attr("width",q).attr("height",t).style("opacity",0).style("cursor","ew-resize").call(G).on("dblclick.zoom",null);null!==Ia&&F.extent("function"!==typeof Ia?Ia:A?Ia(Va,hb):Ia(0,Da()-1));qa&&(w.append("g").attr("clip-path",Ha).attr("class","chart"),w.select(".chart").append("g").attr("class","chart-bars"),w.select(".chart").append("g").attr("class","chart-lines"),w.append("g").attr("clip-path",Ha).attr("class","x brush").call(F).selectAll("rect").attr("height",ea),w.append("g").attr("class","x axis").attr("transform",J.subx).call(wa));sa&&Za(b);mc(b);D({withTransition:!1,withUpdateXDomain:!0});if(Zc){if(A&&"string"===typeof ta){ta=ha(ta);for(a=0;a<b[0].values.length&&0!==b[0].values[a].x-ta;a++);ta=a}X.html(lc(b.map(function(a){return yb(a.values[ta])})));X.style("top",nc.top).style("left",nc.left).style("visibility","visible")}}}function D(a){var b,c,f=Ic(),g=f.__max__+1,e,n,r,u,y;a=p(a)?a:{};b=p(a.withY)?a.withY:!0;u=p(a.withSubchart)?a.withSubchart:!0;y=p(a.withTransition)?a.withTransition:!0;a=p(a.withUpdateXDomain)?a.withUpdateXDomain:!1;y=y?250:0;a&&(m.domain(F.empty()?Q:F.extent()),ja&&G.x(m).updateScaleExtent());x.domain(ba(l.data.targets,"y"));P.domain(ba(l.data.targets,"y2"));k.select(".x.axis").transition().duration(h?y:0).call(h?fa:I);k.select(".y.axis").transition().duration(h?0:y).call(h?I:fa);k.select(".y2.axis").transition().call(Sa);Qa.domain(x.domain());Ra.domain(P.domain());X.style("visibility","hidden");k.select("line.xgrid-focus").style("visibility","hidden").attr("y2",t);if(hc){if("year"===$c)for(a=[],n=Va.getFullYear(),e=hb.getFullYear();n<=e;n++)a.push(new Date(n+"-01-01 00:00:00"));else a=m.ticks(10);a=k.select(".xgrids").selectAll(".xgrid").data(a);a.enter().append("line").attr("class","xgrid");a.exit().remove();k.selectAll(".xgrid").attr("x1",function(a){return m(a)-I.tickOffset()}).attr("x2",function(a){return m(a)-I.tickOffset()}).attr("y1",v).attr("y2",t)}qb&&(a=k.selectAll(".xgrid-lines"),a.selectAll("line").attr("x1",h?0:Ea).attr("x2",h?q:Ea).attr("y1",h?Ea:v).attr("y2",h?Ea:t),a.selectAll("text").attr("x",h?q:0).attr("y",Ea));b&&ic&&(a=k.select(".ygrids").selectAll(".ygrid").data(x.ticks(10)),a.enter().append("line").attr("class","ygrid"),a.attr("x1",h?x:0).attr("x2",h?x:q).attr("y1",h?0:x).attr("y2",h?t:x).attr("opacity",0).transition().attr("opacity",1),a.exit().remove());b&&rb&&k.select(".ygrid-lines").selectAll(".ygrid-line").attr("y1",Tb).attr("y2",Tb);e=Wb(I,g,!1);n=Xb(h?null:t);b=Ub(e,g,f);a=Vb(n,f,h);c=k.selectAll(".-bars").selectAll(".-bar").data(Yb);c.transition().duration(y).attr("x",h?a:b).attr("y",h?b:a).attr("width",h?n:e).attr("height",h?e:n);c.enter().append("rect").attr("class",Sb).attr("x",h?a:b).attr("y",h?b:a).attr("width",h?n:e).attr("height",h?e:n).style("opacity",0).transition().duration(y).style("opacity",1);c.exit().transition().duration(y).style("opacity",0).remove();k.selectAll(".-line").transition().duration(y).attr("d",ad);b=k.selectAll(".-circles").selectAll(".-circle").data(Jc);b.transition().duration(y).style("opacity",function(a){return null===a.value?0:1}).attr("cx",h?V:U).attr("cy",h?U:V);b.enter().append("circle").style("opacity",function(a){return null===a.value?0:1}).attr("class",Gc).attr("cx",h?V:U).attr("cy",h?U:V).attr("r",sb);b.exit().remove();qa&&(null!==d.event&&"zoom"===d.event.type&&F.extent(m.orgDomain()).update(),u&&(w.select(".x.axis").transition().duration(h?y:0).call(h?fa:wa),F.empty()||F.extent(m.orgDomain()).update(),e=Wb(wa,g,!0),n=Xb(ea,!0),b=Ub(e,g,f,!0),a=Vb(n,f,!1,!0),f=w.selectAll(".-bars").selectAll(".-bar").data(Yb),f.transition().duration(y).attr("x",b).attr("y",a).attr("width",e).attr("height",n),f.enter().append("rect").attr("class",Sb).attr("x",b).attr("y",a).attr("width",e).attr("height",n).style("opacity",0).transition().style("opacity",1),f.exit().transition().style("opacity",0).remove(),w.selectAll(".-line").transition().duration(y).attr("d",bd)));k.selectAll(".selected-circles").filter(function(a){return ya(a)}).selectAll("circle").remove();k.selectAll(".selected-circle").transition().duration(y).attr("cx",h?V:U).attr("cy",h?U:V);Pb?(r=function(a,b){var c=0<b?l.data.targets[0].values[b-1].x:void 0;b=b<Da()-1?l.data.targets[0].values[b+1].x:void 0;return(m(b?b:a.x+50)-m(c?c:a.x-50))/2},f=function(a,b){b=0<b?l.data.targets[0].values[b-1].x:void 0;return(m(a.x)+m(b?b:a.x-50))/2}):(r=(h?t:q)*va()/(Da()-1),f=function(a){return m(a.x)-r/2});k.selectAll(".event-rect").attr("x",h?0:f).attr("y",h?f:0).attr("width",h?q:r).attr("height",h?r:t);f=k.select(".regions").selectAll("rect.region").data(K);f.enter().append("rect");f.attr("class",Hc).attr("x",h?0:na).attr("y",h?na:v).attr("width",h?q:Oa).attr("height",h?Oa:t).style("fill-opacity",function(a){return p(a.opacity)?a.opacity:.1});f.exit().transition().duration(y).style("fill-opacity",0).remove()}function cd(){"mousemove"===d.event.sourceEvent.type&&G.altDomain?(m.domain(G.altDomain),G.x(m).updateScaleExtent()):(ga&&m.orgDomain()[0]===Q[0]&&m.domain([Q[0]-1E-10,m.orgDomain()[1]]),D({withTransition:!1,withY:!1,withSubchart:!1}),"mousemove"===d.event.sourceEvent.type&&(tb=!0))}function mc(a){var b;k.select(".chart-bars").selectAll(".chart-bar").data(a).enter().append("g").attr("class",function(a){return"chart-bar target target-"+a.id}).style("pointer-events","none").style("opacity",0).append("g").attr("class",Rb).style("fill",function(a){return R(a.id)}).style("stroke",function(a){return R(a.id)}).style("stroke-width",0).style("cursor",function(a){return la(a)?"pointer":null});b=k.select(".chart-lines").selectAll(".chart-line").data(a).enter().append("g").attr("class",function(a){return"chart-line target target-"+a.id}).style("pointer-events","none").style("opacity",0);b.append("path").attr("class",Qb).style("stroke",function(a){return R(a.id)});b.append("g").attr("class",function(a){return"selected-circles selected-circles-"+a.id});b.append("g").attr("class",bb).style("fill",function(a){return R(a.id)}).style("cursor",function(a){return la(a)?"pointer":null});a.forEach(function(a){k.selectAll(".selected-circles-"+a.id).selectAll(".selected-circle").each(function(b){b.value=a.values[b.x].value})});qa&&(b=w.select(".chart-bars").selectAll(".chart-bar").data(a),b=b.enter().append("g").attr("class",function(a){return"chart-bar target target-"+a.id}).style("opacity",0),b.append("g").attr("class",Rb).style("fill",function(a){return R(a.id)}),b=w.select(".chart-lines").selectAll(".chart-line").data(a),b=b.enter().append("g").attr("class",function(a){return"chart-line target target-"+a.id}).style("opacity",0),b.append("path").attr("class",Qb).style("stroke",function(a){return R(a.id)}));sa&&Za(a);d.selectAll(".target").transition().style("opacity",1)}function Ja(a,b){l.data.targets.forEach(function(b){for(var c=0;c<a.length;c++)if(b.id===a[c].id){b.values=a[c].values;a.splice(c,1);break}});l.data.targets=l.data.targets.concat(a);mc(l.data.targets);D();b()}function Za(a,b){var c=ib(a),f=q/2-Ka*Object.keys(a).length/2;b=r(b)?{}:b;b=p(b.withTransition)?b.withTransition:!0;a=ra.selectAll(".legend-item").data(c).enter().append("g").attr("class",function(a){return"legend-item legend-item-"+a}).style("cursor","pointer").on("click",function(a){dd(a)}).on("mouseover",function(a){d.selectAll(".legend-item").filter(function(b){return b!==a}).transition().duration(100).style("opacity",.3);l.focus(a)}).on("mouseout",function(){d.selectAll(".legend-item").transition().duration(100).style("opacity",1);l.revert()});a.append("rect").attr("class","legend-item-event").style("fill-opacity",0).attr("x",-200).attr("y",function(){return da/2-16}).attr("width",Ka).attr("height",24);a.append("rect").attr("class","legend-item-tile").style("fill",function(a){return R(a)}).attr("x",-200).attr("y",function(){return da/2-9}).attr("width",10).attr("height",10);a.append("text").text(function(a){return p(Ba[a])?Ba[a]:a}).attr("x",-200).attr("y",function(){return da/2});ra.selectAll("rect.legend-item-event").data(c).transition().duration(b?250:0).attr("x",function(a,b){return f+Ka*b});ra.selectAll("rect.legend-item-tile").data(c).transition().duration(b?250:0).attr("x",function(a,b){return f+Ka*b});ra.selectAll("text").data(c).transition().duration(b?250:0).attr("x",function(a,b){return f+Ka*b+14})}function La(a){return p(a)?".target-"+a:".target"}var l={data:{}},Ua={},oa=e(["bindto"],"#chart"),zb=e(["size","width"],null),Ab=e(["size","height"],null),ja=e(["zoom","enabled"],!1),oc=e(["zoom","extent"],null),Yc=e(["zoom","privileged"],!1),Tc=e(["onenter"],function(){}),Uc=e(["onleave"],function(){});if(!("data"in B))throw Error("data is required in config");var ia=e(["data","x"],void 0),ed=e(["data","x_format"],"%Y-%m-%d"),Fc=e(["data","id_converter"],function(a){return a}),Ba=e(["data","names"],{}),u=e(["data","groups"],[]),Lb=e(["data","axes"],{}),W=e(["data","types"],{}),pc=e(["data","regions"],{}),fd=e(["data","colors"],{}),Y=e(["data","selection","enabled"],!1),ka=e(["data","selection","grouped"],!1),la=e(["data","selection","isselectable"],function(){return!0}),qa=e(["subchart","show"],!1),Cb=qa?e(["subchart","size","height"],60):0,gd=e(["color","pattern"],null),sa=e(["legend","show"],!0),Ka=e(["legend","item","width"],80),dd=e(["legend","item","onclick"],function(){}),qc=e(["axis","x","type"],"indexed"),xa=e(["axis","x","categories"],[]),xc=e(["axis","x","tick","centered"],!1),Kb=e(["axis","x","tick","format"],null),Ia=e(["axis","x","default"],null),Bc=e(["axis","y","max"],null),zc=e(["axis","y","min"],null),Dc=e(["axis","y","center"],null),Vc=e(["axis","y","text"],null),eb=e(["axis","y","inner"],!1),Qc=e(["axis","y","format"],function(a){return a}),za=e(["axis","y","padding"],null),Pc=e(["axis","y","ticks"],10),Eb=e(["axis","y2","show"],!1),Ac=e(["axis","y2","max"],null),yc=e(["axis","y2","min"],null),Cc=e(["axis","y2","center"],null),db=e(["axis","y2","inner"],!1),Sc=e(["axis","y2","format"],function(a){return a}),Aa=e(["axis","y2","padding"],null),Rc=e(["axis","y2","ticks"],10),h=e(["axis","rotated"],!1),hc=e(["grid","x","show"],!1),$c=e(["grid","x","type"],"tick"),qb=e(["grid","x","lines"],null),ic=e(["grid","y","show"],!1),rb=e(["grid","y","lines"],null),sb=e(["point","show"],!0)?e(["point","r"],2.5):0,Wc=e(["point","focus","line","enabled"],!0),jc=e(["point","focus","expand","enabled"],!0),kc=e(["point","focus","expand","r"],jc?4:sb),Fa=e(["point","focus","select","r"],8),Xc=e(["point","onclick"],function(){}),Lc=e(["point","onselected"],function(){}),Mc=e(["point","onunselected"],function(){}),K=e(["regions"],[]),lc=e(["tooltip","contents"],function(a){var b;A?b=a[0].x.getFullYear()+"."+(a[0].x.getMonth()+1)+"."+a[0].x.getDate():ga?(b=a[0].x,b=b<xa.length?xa[b]:b):b=a[0].x;b="\x3ctable class\x3d'-tooltip'\x3e\x3ctr\x3e\x3cth colspan\x3d'2'\x3e"+b+"\x3c/th\x3e\x3c/tr\x3e";var c,d,e;for(c=0;c<a.length;c++)p(a[c])?(d=p(a[c].value)?(Math.round(100*a[c].value)/100).toFixed(2):"-",e=a[c].name):e=d="-",b+="\x3ctr class\x3d'-tooltip-name-"+a[c].id+"'\x3e\x3ctd class\x3d'name'\x3e\x3cspan style\x3d'background-color:"+R(a[c].id)+"'\x3e\x3c/span\x3e"+e+"\x3c/td\x3e\x3ctd class\x3d'value'\x3e"+d+"\x3c/td\x3e\x3c/tr\x3e";return b+"\x3c/table\x3e"}),Zc=e(["tooltip","init","show"],!1),ta=e(["tooltip","init","x"],0),nc=e(["tooltip","init","position"],{top:"0px",left:"50px"}),pb=oa.replace("#","")+"-clip",Ha="url(#"+pb+")",A="timeseries"===qc,ga="categorized"===qc,Pb=!A&&ia,ub=null,Ya=!1,tb=!1,da=sa?40:0,ha=d.time.format(ed).parse,R=function(a,b){var c=[],d=null!==b?b:"#E67A77 #79D1CF #D9DD81 #d62728 #9467bd #8c564b #e377c2 #7f7f7f #bcbd22 #17becf".split(" ");return function(b){if(b in a)return a[b];-1===c.indexOf(b)&&c.push(b);return d[c.indexOf(b)%d.length]}}(fd,gd),wc=function(){var a=[[d.time.format("%Y/%-m/%-d"),function(){return!0}],[d.time.format("%-m/%-d"),function(a){return a.getMonth()}],[d.time.format("%-m/%-d"),function(a){return 1!==a.getDate()}],[d.time.format("%-m/%-d"),function(a){return a.getDay()&&1!==a.getDate()}],[d.time.format("%I %p"),function(a){return a.getHours()}],[d.time.format("%I:%M"),function(a){return a.getMinutes()}],[d.time.format(":%S"),function(a){return a.getSeconds()}],[d.time.format(".%L"),function(a){return a.getMilliseconds()}]];return function(b){for(var c=a.length-1,d=a[c];!d[1](b);)d=a[--c];return d[0](b)}}(),Bb,Gb,Db,Pa,Fb,Hb,q,t,ea,cb,pa,Ib,Jb,fb,gb,m,x,P,T,Qa,Ra,I,fa,Sa,wa,sc=h?"left":"bottom",tc=h?eb?"top":"bottom":eb?"right":"left",uc=h?db?"bottom":"top":db?"left":"right",J={main:function(){return"translate("+E+","+v+")"},context:function(){return"translate("+H+","+ua+")"},legend:function(){return"translate("+xb+","+wb+")"},y2:function(){return"translate("+(h?0:q)+","+(h?10:0)+")"},x:function(){return"translate(0,"+t+")"},subx:function(){return"translate(0,"+ea+")"}},ad=function(){var a=d.svg.line().x(h?function(a){return z(a.id)(a.value)}:Wa).y(h?Wa:function(a){return z(a.id)(a.value)});return function(b){var c=ec(b.values),d;if(mb(b))return"spline"===W["string"===typeof b?b:b.id]?a.interpolate("cardinal"):a.interpolate("linear"),0<Object.keys(pc).length?Oc(c,m,z(b.id),pc[b.id]):a(c);d=m(c[0].x);b=z(b.id)(c[0].value);return h?"M "+b+" "+d:"M "+d+" "+b}}(),bd=function(){var a=d.svg.line().x(function(a){return T(a.x)}).y(function(a){return Ma(a.id)(a.value)});return function(b){var c=ec(b.values);return mb(b)?a(c):"M "+T(c[0].x)+" "+Ma(b.id)(c[0].value)}}(),F=d.svg.brush().on("brush",function(){D({withTransition:!1,withY:!1,withSubchart:!1,withUpdateXDomain:!0})}),G=d.behavior.zoom().on("zoomstart",function(){G.altDomain=d.event.sourceEvent.altKey?m.orgDomain():null}).on("zoom",ja?cd:null);F.update=function(){w&&w.select(".x.brush").call(this);return this};G.orgScaleExtent=function(){var a=oc?oc:[1,10];return[a[0],Math.max(Da()/a[1],a[1])]};G.updateScaleExtent=function(){var a=m.orgDomain(),a=(a[1]-a[0])/(Q[1]-Q[0]),b=this.orgScaleExtent();this.scaleExtent([b[0]*a,b[1]*a]);return this};var Ga,Xa,k,w,ra,X,gc,Va=null,hb=null,Q;l.focus=function(a){l.defocus();d.selectAll(La(a)).filter(function(a){return jb(a.id)}).classed("focused",!0).transition().duration(100).style("opacity",1)};l.defocus=function(a){d.selectAll(La(a)).filter(function(a){return jb(a.id)}).classed("focused",!1).transition().duration(100).style("opacity",.3)};l.revert=function(a){d.selectAll(La(a)).filter(function(a){return jb(a.id)}).classed("focused",!1).transition().duration(100).style("opacity",1)};l.show=function(a){d.selectAll(La(a)).transition().style("opacity",1)};l.hide=function(a){d.selectAll(La(a)).transition().style("opacity",0)};l.unzoom=function(){F.clear().update();D({withUpdateXDomain:!0})};l.load=function(a){r(a.done)&&(a.done=function(){});"categories"in a&&ga&&(xa=a.categories,I.categories(xa));if("cacheIds"in a&&ma(a.cacheIds))Ja(Na(a.cacheIds),a.done);else if("data"in a)Ja(Ca(a.data),a.done);else if("url"in a)d.csv(a.url,function(b,c){Ja(Ca(c),a.done)});else if("rows"in a)Ja(Ca(Nb(a.rows)),a.done);else if("columns"in a)Ja(Ca(Ob(a.columns)),a.done);else throw Error("url or rows or columns is required.");};l.unload=function(a){l.data.targets=l.data.targets.filter(function(b){return b.id!==a});d.selectAll(".target-"+a).transition().style("opacity",0).remove();sa&&(d.selectAll(".legend-item-"+a).remove(),Za(l.data.targets));0<l.data.targets.length&&D()};l.selected=function(a){a=p(a)?"-"+a:"";return d.merge(k.selectAll(".-shapes"+a).selectAll(".-shape").filter(function(){return d.select(this).classed("_selected_")}).map(function(a){return a.map(function(a){return a.__data__})}))};l.select=function(a,b,c){Y&&k.selectAll(".-shapes").selectAll(".-shape").each(function(e,g){var f="circle"===this.nodeName?ac:Nc,h="circle"===this.nodeName?nb:cc;0<=b.indexOf(g)?la(e)&&(ka||r(a)||0<=a.indexOf(e.id))&&f(d.select(this).classed("_selected_",!0),e,g):p(c)&&c&&h(d.select(this).classed("_selected_",!1),e,g)})};l.unselect=function(a,b){Y&&k.selectAll(".-shapes").selectAll(".-shape").each(function(c,e){var f="circle"===this.nodeName?nb:cc;(r(b)||0<=b.indexOf(e))&&la(c)&&(ka||r(a)||0<=a.indexOf(c.id))&&f(d.select(this).classed("_selected_",!1),c,e)})};l.toLine=function(a){lb(a,"line");D()};l.toSpline=function(a){lb(a,"spline");D()};l.toBar=function(a){lb(a,"bar");D()};l.groups=function(a){if(r(a))return u;u=a;D();return u};l.regions=function(a){if(r(a))return K;K=a;D();return K};l.regions.add=function(a){if(r(a))return K;K=K.concat(a);D();return K};l.regions.remove=function(a,b){a=[].concat(a);b=p(b)?b:{};a.forEach(function(a){var c=d.selectAll("."+a);p(b.duration)&&(c=c.transition().duration(b.duration).style("fill-opacity",0));c.remove();K=K.filter(function(b){return 0>b.classes.indexOf(a)})});return K};l.data.get=function(a){a=l.data.getAsTarget(a);return p(a)?a.values.map(function(a){return a.value}):void 0};l.data.getAsTarget=function(a){var b=Ta(function(b){return b.id===a});return 0<b.length?b[0]:void 0};if("url"in B.data)d.csv(B.data.url,function(a,b){ob(b)});else if("rows"in B.data)ob(Nb(B.data.rows));else if("columns"in B.data)ob(Ob(B.data.columns));else throw Error("url or rows or columns is required.");Z.onresize=function(){S();vb();F.x(T);ja&&G.x(m);d.select("svg").attr("width",cb).attr("height",pa);d.select("#"+pb).select("rect").attr("width",q).attr("height",t);d.select("#xaxis-clip").select("rect").attr("width",q+2);d.select(".zoom-rect").attr("width",q).attr("height",t);k.select(".x.axis").attr("transform",J.x);k.select(".y2.axis").attr("transform",J.y2);qa&&(w.select(".x.brush").selectAll("rect").attr("height",ea),w.attr("transform",J.context),w.select(".x.axis").attr("transform",J.subx));sa&&(ra.attr("transform",J.legend),Za(l.data.targets,{withTransition:!1}));D({withTransition:!1,withUpdateXDomain:!0})};return l}})(window);