'use strict';var myDisposeFlow={init:function(){this.loadData();this.loadEvent()},loadData:function(){table.init({id:"#flowDisposeTable",url:common.root+"/flow/getDisposetTaskList.do",columns:"typenames,task_code,name,createtime,statename,step_name,step_state_name,\x3cbutton title\x3d'\u5904\u7406' onclick\x3d'myDisposeFlow.edit(this);' class\x3d\"button button-circle button-tiny\"\x3e\x3ci class\x3d\"fa fa-edit\"\x3e\x3c/i\x3e\x3c/button\x3e".split(","),param:function(){var a=[];a.push({name:"taskCode",value:$("#taskCode").val()});a.push({name:"taskName",value:$("#taskName").val()});a.push({name:"sendTime",value:$("#sendTime").val()});for(var c=$(".flowtypediv select").size(),b="-",d=0;d<c;d++){var f=$("#flowType"+d).val();""!=f&&(b+=f+"-")}b=b.substr(1);common.log(b);b=b.substr(0,b.length-1);common.log(b);c=0<=b.indexOf("-")?b.substr(b.lastIndexOf("-")+1):b;common.log(c);a.push({name:"types",value:b});a.push({name:"typelike",value:c});a.push({name:"lx",value:2});return a}})},loadEvent:function(){$(".flowtypediv ").on("change","select[t\x3d'type']",function(){for(var a=$(this).val(),b=$(this).attr("id").replace("flowType",""),d=$(".flowtypediv select").size(),f=d;f>b;f--)$("#flowType"+f).remove();""!=a&&common.ajax({url:common.root+"/flow/getType.do",data:{sup:a},dataType:"json",loadfun:function(a,c){if(a)if(common.log(c),0<c.list.length){a='\x3cselect class\x3d"form-control" t\x3d"type" id\x3d"flowType'+d+'" name\x3d"flowType'+d+'" \x3e\x3coption value\x3d"" \x3e\u8bf7\u9009\u62e9...\x3c/option\x3e';for(var e=0;e<c.list.length;e++)a+='\x3coption value\x3d"'+c.list[e].type_id+'" \x3e'+c.list[e].type_name+"\x3c/option\x3e";a+="\x3c/select\x3e";$(".flowtypediv").append(a)}else for(e=d;e>b;e--)$("#flowType"+e).remove();else common.alert(common.msg.error)}})});var a=new Date;$("#sendTime").daterangepicker({startDate:a.getFullYear()+"-"+(a.getMonth()+1)+"-02",timePicker12Hour:!1,timePicker:!0,separator:"\u81f3",timePickerIncrement:10,format:"YYYY-MM-DD HH:mm"},function(a,b,d){common.log(a.toISOString(),b.toISOString(),d)})},edit:function(a){a=table.getRowData("flowDisposeTable",a);common.log(a);common.openWindow({url:common.root+"/flow/showDetailFlowDetail.do?step_id\x3d"+a.step_id+"\x26task_cfg_id\x3d"+a.task_cfg_id,name:"showDisposeFlowDetail",type:3,data:{}})}};$(function(){myDisposeFlow.init()});