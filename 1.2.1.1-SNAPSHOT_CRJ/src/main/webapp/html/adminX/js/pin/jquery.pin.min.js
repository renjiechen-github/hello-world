'use strict';(function(f){f.fn.pin=function(a){var g=0,h=[],q=!1,m=f(window);a=a||{};var p=function(){for(var k=0,e=h.length;k<e;k++){var b=h[k];if(a.minWidth&&m.width()<=a.minWidth)b.parent().is(".pin-wrapper")&&b.unwrap(),b.css({width:"",left:"",top:"",position:""}),a.activeClass&&b.removeClass(a.activeClass),q=!0;else{q=!1;var c=a.containerSelector?b.closest(a.containerSelector):f(document.body),d=b.offset(),l=c.offset(),n=b.offsetParent().offset();b.parent().is(".pin-wrapper")||b.wrap("\x3cdiv class\x3d'pin-wrapper'\x3e");var g=f.extend({top:0,bottom:0},a.padding||{});b.data("pin",{pad:g,from:(a.containerSelector?l.top:d.top)-g.top,to:l.top+c.height()-b.outerHeight()-g.bottom,end:l.top+c.height(),parentTop:n.top});b.css({width:b.outerWidth()});b.parent().css("height",b.outerHeight())}}},r=function(){if(!q){g=m.scrollTop();for(var k=[],e=0,b=h.length;e<b;e++){var c=f(h[e]),d=c.data("pin");if(d){k.push(c);var l=d.from-d.pad.bottom,n=d.to-d.pad.top;l+c.outerHeight()>d.end?c.css("position",""):l<g&&n>g?("fixed"!=c.css("position")&&c.css({left:c.offset().left,top:d.pad.top}).css("position","fixed"),a.activeClass&&c.addClass(a.activeClass)):g>=n?(c.css({left:"",top:n-d.parentTop+d.pad.top}).css("position","absolute"),a.activeClass&&c.addClass(a.activeClass)):(c.css({position:"",top:"",left:""}),a.activeClass&&c.removeClass(a.activeClass))}}h=k}},t=function(){p();r()};this.each(function(){var a=f(this),e=f(this).data("pin")||{};e&&e.update||(h.push(a),f("img",this).one("load",p),e.update=t,f(this).data("pin",e))});m.scroll(r);m.resize(function(){p()});p();m.load(t);return this}})(jQuery);