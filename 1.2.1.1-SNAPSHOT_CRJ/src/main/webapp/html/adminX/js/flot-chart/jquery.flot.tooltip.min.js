'use strict';(function(c){var e=function(a){this.tipPosition={x:0,y:0};this.init(a)};e.prototype.init=function(a){function b(a){var b={};b.x=a.pageX;b.y=a.pageY;d.updateTooltipPosition(b)}function f(b,a,c){b=d.getDomElement();if(c){var f;f=d.stringFormat(d.tooltipOptions.content,c);b.html(f);d.updateTooltipPosition({x:a.pageX,y:a.pageY});b.css({left:d.tipPosition.x+d.tooltipOptions.shifts.x,top:d.tipPosition.y+d.tooltipOptions.shifts.y}).show();if("function"===typeof d.tooltipOptions.onHover)d.tooltipOptions.onHover(c,b)}else b.hide().html("")}var d=this;a.hooks.bindEvents.push(function(a,e){d.plotOptions=a.getOptions();!1!==d.plotOptions.tooltip&&"undefined"!==typeof d.plotOptions.tooltip&&(d.tooltipOptions=d.plotOptions.tooltipOpts,d.getDomElement(),c(a.getPlaceholder()).bind("plothover",f),c(e).bind("mousemove",b))});a.hooks.shutdown.push(function(a,d){c(a.getPlaceholder()).unbind("plothover",f);c(d).unbind("mousemove",b)})};e.prototype.getDomElement=function(){var a;0<c("#flotTip").length?a=c("#flotTip"):(a=c("\x3cdiv /\x3e").attr("id","flotTip"),a.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&a.css({background:"#fff","z-index":"100",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"}));return a};e.prototype.updateTooltipPosition=function(a){var b=c("#flotTip").outerWidth()+this.tooltipOptions.shifts.x,f=c("#flotTip").outerHeight()+this.tooltipOptions.shifts.y;a.x-c(window).scrollLeft()>c(window).innerWidth()-b&&(a.x-=b);a.y-c(window).scrollTop()>c(window).innerHeight()-f&&(a.y-=f);this.tipPosition.x=a.x;this.tipPosition.y=a.y};e.prototype.stringFormat=function(a,b){var c=/%p\.{0,1}(\d{0,})/,d=/%s/,e=/%x\.{0,1}(?:\d{0,})/,g=/%y\.{0,1}(?:\d{0,})/;"function"===typeof a&&(a=a(b.series.label,b.series.data[b.dataIndex][0],b.series.data[b.dataIndex][1],b));"undefined"!==typeof b.series.percent&&(a=this.adjustValPrecision(c,a,b.series.percent));"undefined"!==typeof b.series.label&&(a=a.replace(d,b.series.label));this.isTimeMode("xaxis",b)&&this.isXDateFormat(b)&&(a=a.replace(e,this.timestampToDate(b.series.data[b.dataIndex][0],this.tooltipOptions.xDateFormat)));this.isTimeMode("yaxis",b)&&this.isYDateFormat(b)&&(a=a.replace(g,this.timestampToDate(b.series.data[b.dataIndex][1],this.tooltipOptions.yDateFormat)));"number"===typeof b.series.data[b.dataIndex][0]&&(a=this.adjustValPrecision(e,a,b.series.data[b.dataIndex][0]));"number"===typeof b.series.data[b.dataIndex][1]&&(a=this.adjustValPrecision(g,a,b.series.data[b.dataIndex][1]));"undefined"!==typeof b.series.xaxis.tickFormatter&&(a=a.replace(e,b.series.xaxis.tickFormatter(b.series.data[b.dataIndex][0],b.series.xaxis)));"undefined"!==typeof b.series.yaxis.tickFormatter&&(a=a.replace(g,b.series.yaxis.tickFormatter(b.series.data[b.dataIndex][1],b.series.yaxis)));return a};e.prototype.isTimeMode=function(a,b){return"undefined"!==typeof b.series[a].options.mode&&"time"===b.series[a].options.mode};e.prototype.isXDateFormat=function(a){return"undefined"!==typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat};e.prototype.isYDateFormat=function(a){return"undefined"!==typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat};e.prototype.timestampToDate=function(a,b){return c.plot.formatDate(new Date(a),b)};e.prototype.adjustValPrecision=function(a,b,c){var d;null!==b.match(a)&&""!==RegExp.$1&&(d=RegExp.$1,c=c.toFixed(d),b=b.replace(a,c));return b};c.plot.plugins.push({init:function(a){new e(a)},options:{tooltip:!1,tooltipOpts:{content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,shifts:{x:10,y:20},defaultTheme:!0,onHover:function(a,b){}}},name:"tooltip",version:"0.6.1"})})(jQuery);