if(typeof njyc=='undefined'){var njyc=new Object()}function execute(url){var iframe=document.createElement("IFRAME");iframe.setAttribute("src",url);document.documentElement.appendChild(iframe);iframe.parentNode.removeChild(iframe);iframe=null}function showOrHide(hide1){var id="#"+hide1;var display=$(id).css('display');if(display=='none'){$(id).show()}else{$(id).hide()}}function showOrHide(hide2){var id="#"+hide2;var display=$(id).css('display');if(display=='none'){$(id).show()}else{$(id).hide()}}function showOrHide(hide3){var id="#"+hide3;var display=$(id).css('display');if(display=='none'){$(id).show()}else{$(id).hide()}}var xxx='';var t1=null;var t3=null;njyc.phone={clientType:/android/i.test(navigator.userAgent)?'ANDROID':(/ipad|iphone|mac/i.test(navigator.userAgent)?'IOS':'PC'),showAlert:function(msg){if(this.clientType=='ANDROID'){window.client.showAlert(msg)}else if(this.clientType=='IOS'){var url="cmopios::showAlert::"+msg;execute(url)}else{}},showProgress:function(msg){if(this.clientType=='ANDROID'){window.client.showProgress(msg)}else if(this.clientType=='IOS'){var url="cmopios::showProgress::"+msg;execute(url)}else{}},closeProgress:function(){if(this.clientType=='ANDROID'){window.client.closeProgress()}else if(this.clientType=='IOS'){var url="cmopios::closeProgress";execute(url)}else{}},showShortMessage:function(msg){if(this.clientType=='ANDROID'){window.client.showShortMessage(msg)}else if(this.clientType=='IOS'){var url="cmopios::showShortMessage::"+msg;execute(url)}else{}},openWebKit:function(opt){var def={url:'',title:'',titleFlag:'1',screenType:'0',param:'',hasRightBtn:'',rightIcon:'',rightJs:'',hasRightBtn1:'',rightIcon1:'',rightJs1:'',isref:'1'};jQuery.extend(def,opt);console.log(def.url)if(this.clientType=='ANDROID'){window.client.openWebKit(def.url,def.title,def.titleFlag,def.screenType,def.param,def.hasRightBtn,def.rightIcon,def.rightJs,def.hasRightBtn1,def.rightIcon1,def.rightJs1,def.isref)}else if(this.clientType=='IOS'){var url="cmopios::openWebKit::"+def.url+"::"+def.title+"::"+def.titleFlag+"::"+def.screenType+"::"+def.param+"::"+def.hasRightBtn+"::"+def.rightIcon+"::"+def.rightJs+"::"+def.hasRightBtn1+"::"+def.rightIcon1+"::"+def.rightJs1+"::"+def.isref;execute(url)}else{}},closeWebView:function(){if(this.clientType=='ANDROID'){window.client.closeWebView()}else if(this.clientType=='IOS'){var url="cmopios::closeWebView";execute(url)}else{}},closeWebViewRef:function(className){if(this.clientType=='ANDROID'){window.client.closeWebViewRef(className)}else if(this.clientType=='IOS'){var url="cmopios::closeWebViewRef::"+className;execute(url)}else{}},closeCallBack:function(jsStr){if(this.clientType=='ANDROID'){window.client.closeCallBack(jsStr)}else if(this.clientType=='IOS'){var url="cmopios::closeCallBack::"+jsStr;execute(url)}else{}},getLastLocation:function(){if(this.clientType=='ANDROID'){return window.client.getLastLocation()}else if(this.clientType=='IOS'){xxx=''var url="cmopios::getLastLocation";execute(url)return xxx}else{}},getLocation2:function(jsStr){if(this.clientType=='ANDROID'){window.client.getLocation2(jsStr)}else if(this.clientType=='IOS'){var url="cmopios::getLocation2::"+jsStr;execute(url)}else{}},getSysInfo:function(key){if(this.clientType=='ANDROID'){return window.client.getSysInfo(key)}else if(this.clientType=='IOS'){return"http://manager.room1000.com:8187/"}else{}},navigationMap:function(opt){var def={latlng:'latlng:118.741195,32.059332|name:我的位置',dist:''};jQuery.extend(def,opt);if(this.clientType=='ANDROID'){return window.client.navigationMap(def.latlng,def.dist)}else if(this.clientType=='IOS'){xxx='';var url="cmopios::navigationMap::"+def.latlng;execute(url)return xxx}else{}},scanRQcode:function(jsCallBack){if(this.clientType=='ANDROID'){return window.client.scanQRCode(jsCallBack)}else if(this.clientType=='IOS'){xxx='';var url="cmopios::scanQRCode::"+jsCallBack;execute(url)return xxx}else{}},getUserInfo:function(key){if(this.clientType=='ANDROID'){return window.client.getUserInfo(key)}else if(this.clientType=='IOS'){xxx='';var url="cmopios::getUserInfo::"+key;execute(url)return xxx}else{}},showSelectDlg:function(data,textId,valueId,textKey,valueKey,hasSearch){if(this.clientType=='ANDROID'){window.client.showSelectDlg(data,textId,valueId,textKey,valueKey,hasSearch)}else if(this.clientType=='IOS'){var url="cmopios::showSelectDlg::"+data.replace(/\'/gi,'\"')+"::"+textId+"::"+valueId+"::"+textKey+"::"+valueKey+"::"+hasSearch;execute(url)}else{}},showDateDlg:function(type,domId,defaultValue){if(this.clientType=='ANDROID'){window.client.showDateDlg(type,domId,defaultValue)}else if(this.clientType=='IOS'){var url="cmopios::showDateDlg::"+type+"::"+domId+"::"+defaultValue;execute(url)}else{}},openCamera:function(fileNameShowDom,filePathDom,fileIdDom,fileNameDom){if(this.clientType=='ANDROID'){window.client.openCamera(fileNameShowDom,filePathDom,fileIdDom,fileNameDom)}else if(this.clientType=='IOS'){var url="cmopios::openCamera::"+fileNameShowDom+"::"+filePathDom+"::"+fileIdDom+"::"+fileNameDom;execute(url)}else{}},selectImageForPhoto:function(fileNameShowDom,filePathDom,fileIdDom,fileNameDom){if(this.clientType=='ANDROID'){window.client.selectImageForPhoto(fileNameShowDom,filePathDom,fileIdDom,fileNameDom)}else if(this.clientType=='IOS'){var url="cmopios::openCamera::"+fileNameShowDom+"::"+filePathDom+"::"+fileIdDom+"::"+fileNameDom;execute(url)}else{}},openFileSelect:function(fileType,fileNameShowDom,filePathDom,fileIdDom,fileNameDom){if(this.clientType=='ANDROID'){window.client.openFileSelect(fileType,fileNameShowDom,filePathDom,fileIdDom,fileNameDom)}else if(this.clientType=='IOS'){var url="cmopios::openCamera::"+fileNameShowDom+"::"+filePathDom+"::"+fileIdDom+"::"+fileNameDom;execute(url)}else{}},submitFileForm:function(formDomId,filePaths,fileIds,fileSavePath){if(this.clientType=='ANDROID'){window.client.submitFormWithMultiFiles(formDomId,filePaths,fileIds,fileSavePath)}else if(this.clientType=='IOS'){var url="cmopios::submitFormWithMultiFiles::"+formDomId+"::"+filePaths+"::"+fileIds+"::"+fileSavePath;execute(url)}else{}},submitFileAjaxForm:function(jscript,filePaths,fileIds,fileSavePath,errorjscript){if(this.clientType=='ANDROID'){window.client.submitFormWithMultiFiles2(jscript,filePaths,fileIds,fileSavePath,errorjscript)}else if(this.clientType=='IOS'){var url="cmopios::submitFormWithMultiFiles::"+jscript+"::"+filePaths+"::"+fileIds+"::"+fileSavePath;execute(url)}else{}},previewServerPhoto:function(photoPath){if(this.clientType=='ANDROID'){window.client.previewServerPhoto(photoPath)}else if(this.clientType=='IOS'){var url="cmopios::previewServerPhoto::"+photoPath;execute(url)}else{}},previewClientPhoto:function(photoPath){if(this.clientType=='ANDROID'){window.client.previewClientPhoto(photoPath)}else if(this.clientType=='IOS'){var url="cmopios::previewClientPhoto::"+photoPath;execute(url)}else{}},selectImage:function(picNumber,selector){if(this.clientType=='ANDROID'){window.client.selectImage(picNumber,selector)}else if(this.clientType=='IOS'){var url="cmopios::selectImage::"+picNumber+"::"+selector;execute(url)}else{}},showPic:function(picPath,selector){if(!common.isEmpty(selector)){if(common.isEmpty(picPath)){return}var picSize=$('#picSize').val();picPath=picPath.split('|');for(var i=0;i<picPath.length;i++){var url=picPath[i];var newUrl='';if(url.indexOf('/tmp/')>-1){newUrl=njyc.phone.getSysInfo('serverPath')+url}else{newUrl=url}var html='<li class="imgbox">'+' <b class="item_new_close item_close" href="javascript:void(0)" onclick="njyc.phone.deletImage(this)" data_select="'+selector+'" data_src="'+newUrl+'"  title="删除"></b>'+' <a data-lightbox="example-set" href="'+newUrl+'"><input type="hidden" value="'+url+'" name="picImage"><span class="item_box"><img src="'+newUrl+'" width="50" height="50" onclick="return false;">'+' </span></a></li>';$('#'+selector+'').append(html);var pathImageSize=$('#'+selector+'').find('.imgbox').size();if(pathImageSize>=picSize){$('#'+selector).prev().hide();}}}else{if(!common.isEmpty(picPath)){var picSize=$('#picSize').val();picPath=picPath.split('|');for(var i=0;i<picPath.length;i++){var url=picPath[i];var newUrl='';if(url.indexOf('/tmp/')>-1){newUrl=njyc.phone.getSysInfo('serverPath')+url}else{newUrl=url}var pathImageSize=$('.imgbox').size();var html='<li class="imgbox">'+' <b class="item_new_close item_close" href="javascript:void(0)" onclick="njyc.phone.deletImage(this)" data_select="" data_src="'+newUrl+'"  title="删除"></b>'+' <a data-lightbox="example-set" href="'+newUrl+'"><input type="hidden" value="'+url+'" name="picImage"><span class="item_box"><img src="'+newUrl+'">'+' </span></a></li>';$('.ipost-list').append(html);pathImageSize=$('.ipost-list').find('.imgbox').size();if(pathImageSize>=picSize){$('#selectImage').hide()}}}}},showPicById:function(picPath,selector){},deletImage:function(obj){var picSize=$('#picSize').val();var selector=$(obj).attr('data_select');var dataUrl=$(obj).attr('data_src');if((selector.indexOf('selectImage1')>-1||selector.indexOf('selectPropertyPath')>-1||selector.indexOf('selectAgentPath')>-1)&&dataUrl.indexOf('/tmp/')==-1){var path="";var returnI=false;var filepath=$('#'+selector+' input[name="picImage"]');for(var i=0;i<filepath.length;i++){path+=','+$(filepath[i]).val();returnI=true}if(returnI){path=path.substring(1)}if(selector.indexOf('selectImage1')>-1){selector='file_path'}else if(selector.indexOf('selectPropertyPath')>-1){selector='propertyPath'}else{selector='agentPath'}window.wxc.xcConfirm('此文件删除后不能恢复，是否删除？',window.wxc.xcConfirm.typeEnum.confirm,{title:'提示',onOk:function(){njyc.phone.ajax({url:njyc.phone.getSysInfo('serverPath')+'/mobile/houseMgr/removeRemotFile.do',dataType:'json',data:{id:$('#agreementId').val(),src:dataUrl,type:selector,filePath:path},loadfun:function(isloadsucc,data){if(isloadsucc){if(data.state!=-1){var pathImageSize=$(obj).parent().parent().parent().find('.imgbox').size()-1;if(pathImageSize<picSize){$(obj).parent().parent().parent().parent().find('.file').show();$(obj).parent().parent().parent().find('.file').show()}$(obj).parent().remove()}else{njyc.phone.showShortMessage('网络忙,请稍候重试!')}}}})},onCancel:function(){}})}else{var pathImageSize=$(obj).parent().parent().parent().find('.imgbox').size()-1;if(pathImageSize<picSize){$(obj).parent().parent().parent().parent().find('.file').show();$(obj).parent().parent().parent().find('.file').show()}$(obj).parent().remove()}},initCookie:function(){if(this.clientType=='ANDROID'){}else if(this.clientType=='IOS'){document.cookie='httpServerPort='+njyc.phone.getSysInfo('httpServerPort')+';path=/'document.cookie='client_type=IOS;path=/';document.cookie='CMOPBASE='+njyc.phone.getSysInfo('CMOPBASE')+';path=/';document.cookie='mobileModel='+njyc.phone.getSysInfo('mobileModel')+';path=/';document.cookie='versionName='+njyc.phone.getSysInfo('versionName')+';path=/';document.cookie='versionIoS='+njyc.phone.getSysInfo('versionIoS')+';path=/';document.cookie='ORG_ID='+njyc.phone.getSysInfo('ORG_ID')+';path=/';document.cookie='POST_ID='+njyc.phone.getSysInfo('POST_ID')+';path=/'document.cookie='aaa=wwe;path=/'}else{}},showAlertSelDialog:function(data){if(this.clientType=='ANDROID'){window.client.showAlertSelDialog(data)}else if(this.clientType=='IOS'){var url="cmopios::showAlertSelDialog::"+data;execute(url)}else{}},gotoSetting:function(){if(this.clientType=='ANDROID'){window.client.gotoSetting()}else if(this.clientType=='IOS'){var url="cmopios::gotoSetting";execute(url)}else{}},getLocation:function(){if(this.clientType=='ANDROID'){window.client.getLocation()}else if(this.clientType=='IOS'){var url="cmopios::gotoSetting";execute(url)}else{}},showAddressInfo:function(jsonStr){var json=eval('('+jsonStr+')');if(common.isEmpty(json.address)){njyc.phone.showShortMessage('地址获取失败,请重新获取');return}$('#groupAddress').val(json.address);$('#groupCoordinate').val(json.jwd);},callSomeOne:function(tel){if(this.clientType=='ANDROID'){window.client.callSomeOne("tel:"+tel)}else if(this.clientType=='IOS'){var url="cmopios::callSomeOne::"+tel;execute(url)}},logOut:function(){if(this.clientType=='ANDROID'){window.client.logOut()}else if(this.clientType=='IOS'){var url="cmopios::logOut";execute(url)}},loginOut:function(){if(this.clientType=='ANDROID'){window.client.loginOut()}else if(this.clientType=='IOS'){var url="cmopios::loginOut";execute(url)}},eidtUserInfo:function(){if(this.clientType=='ANDROID'){window.client.eidtUserInfo()}else if(this.clientType=='IOS'){var url="cmopios::eidtUserInfo";execute(url)}},ajax:function(opt){var def={url:'',dataType:'text',async:true,type:'post',timeout:100000,loadfun:function(isloadsucc,data){},data:{},delay:0,encode:true,cache:false};jQuery.extend(def,opt);if(def.encode){if(typeof(def.data)!='string'&&def.data!=null&&def.data!=undefined){for(var p in def.data){var value=def.data[p];def.data[p]=encodeURIComponent(value)}}else{var value=decodeURIComponent(def.data,true);def.data=encodeURI(encodeURI(value))}}if(def.delay!=0&&typeof(def.delay)=='number'){setTimeout(function(){$.ajax({type:def.type,url:def.url,data:def.data,dataType:def.dataType,cache:def.cache,async:def.async,timeout:def.timeout,success:function(data){njyc.phone.closeProgress();try{if(data.state=='-99999'){njyc.phone.showShortMessage('您还未登陆或登陆已经失效，请登录!');njyc.phone.loginOut();return}else if(data.state=='-99998'){njyc.phone.showShortMessage('很抱歉，您没有权限进行此操作!');return}def.loadfun(true,data)}catch(e){console.error(e);def.loadfun(false,e)}},error:function(data){console.error(data);def.loadfun(false,data)}})},def.delay)}else{$.ajax({type:def.type,url:def.url,data:def.data,dataType:def.dataType,cache:def.cache,async:def.async,timeout:def.timeout,success:function(data){njyc.phone.closeProgress();try{if(data.state=='-99999'){njyc.phone.showShortMessage('您还未登陆或登陆已经失效，请登录!');njyc.phone.loginOut();return}else if(data.state=='-99998'){njyc.phone.showShortMessage('很抱歉，您没有权限进行此操作!');return}def.loadfun(true,data)}catch(e){console.error(e);def.loadfun(false,e)}},error:function(data){console.error(data);njyc.phone.closeProgress();def.loadfun(false,data)}})}},loadItem:function(group_id,fun,async){if(async==undefined){async=true}njyc.phone.ajax({url:njyc.phone.getSysInfo('serverPath')+'sys/queryItem.do',data:{group_id:group_id},dataType:'json',async:async,loadfun:function(isloadsucc,data){if(isloadsucc){if(data.state==1){fun(data.list)}else{njyc.phone.showShortMessage('网络错误,请稍候重试')}}else{njyc.phone.showShortMessage('网络错误,请稍候重试')}}})},loadArea:function(fatherid,type,fun,async){if(async==undefined){async=true}njyc.phone.ajax({url:njyc.phone.getSysInfo('serverPath')+'sys/queryArea.do',data:{fatherid:fatherid,type:type},async:async,dataType:'json',loadfun:function(isloadsucc,data){if(isloadsucc){if(data.state==1){fun(data.list)}else{njyc.phone.showShortMessage('网络错误,请稍候重试')}}else{njyc.phone.showShortMessage('网络错误,请稍候重试')}}})},queryString:function(name){return njyc.phone.urlSearch(name);},urlSearch:function(val){var name,value;var str=location.href;var num=str.indexOf("?")str=str.substr(num+1);var arr=str.split("&");for(var i=0;i<arr.length;i++){num=arr[i].indexOf("=");if(num>0){name=arr[i].substring(0,num);value=arr[i].substr(num+1);if(name==val){return decodeURI(decodeURI(value))}}}return''}}function showSchDlg(){$('#searchDlg').show();$('#ibg').show()}function hideSchDlg(){$('#searchDlg').hide();$('#ibg').hide()}function noBarsOnTouchScreen(arg){var elem,tx,ty;if('ontouchstart'in document.documentElement){if(elem=document.getElementById(arg)){elem.style.overflow='hidden';elem.ontouchstart=ts;elem.ontouchmove=tm}}function ts(e){var tch;if(e.touches.length==1){e.stopPropagation();tch=e.touches[0];tx=tch.pageX;ty=tch.pageY}}function tm(e){var tch;if(e.touches.length==1){e.preventDefault();e.stopPropagation();tch=e.touches[0];this.scrollTop+=ty-tch.pageY;ty=tch.pageY}}}function setSelectValue(selectId,selectValue,optionValue,optionLabel){var jsonData=eval($('#'+selectId+'_search').attr('data'));for(var j=0;j<jsonData.length;j++){if(selectValue==jsonData[j][optionValue]){$('#'+selectId+'_search').html(jsonData[j][optionLabel]);$('#'+selectId).val(jsonData[j][optionValue]);break}}}function replaceNull(oldValue){if(oldValue=='null'||oldValue==null){return''}return oldValue}function getRow(src){var row=src;while(row&&row.tagName!="TR"){row=row.parentElement}return row}function requestCheck(){if(t1==null){t1=new Date().getTime()}else{var t2=new Date().getTime();if(t2-t1<1000){t1=t2;return false}else{t1=t2}}return true}function requestCheck2(){if(t3==null){t3=new Date().getTime()}else{var t4=new Date().getTime();if(t4-t3<1000){t3=t4;return false}else{t3=t4}}return true}$(function(){njyc.phone.initCookie();})